(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[272],{1540:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/history",function(){return n(5265)}])},5265:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var o=n(7876),i=n(4232),a=n(6670),r=n(1965),d=n(9799),c=n(4312),l=n(4553);let s=["المرحلة الأولى: تحديد المشكلة القانونية","المرحلة الثانية: جمع المعلومات والوثائق","المرحلة الثالثة: تحليل النصوص القانونية","المرحلة الرابعة: تحديد القواعد القانونية المنطبقة","المرحلة الخامسة: تحليل السوابق القضائية","المرحلة السادسة: تحليل الفقه القانوني","المرحلة السابعة: تحليل الظروف الواقعية","المرحلة الثامنة: تحديد الحلول القانونية الممكنة","المرحلة التاسعة: تقييم الحلول القانونية","المرحلة العاشرة: اختيار الحل الأمثل","المرحلة الحادية عشرة: صياغة الحل القانوني","المرحلة الثانية عشرة: تقديم التوصيات"],p={resultBg:"linear-gradient(135deg, #f5f7ff 0%, #e0e7ff 100%)"},f={card:"#232946"};function x(){let{theme:e,darkMode:t}=(0,d.D)(),[n,x]=(0,i.useState)(!1),[h,b]=(0,i.useState)([]),[m,y]=(0,i.useState)(null),[w,S]=(0,i.useState)(null),[j,v]=(0,i.useState)(""),[k,z]=(0,i.useState)(""),[C,R]=(0,i.useState)("");(0,i.useEffect)(()=>{x(!0),(0,a.x1)().then(e=>{e&&e.length>0&&b(e.map(e=>({...e,chats:e.chats||[]})))})},[]),(0,i.useEffect)(()=>{(0,a.W_)(h)},[h]);let W=e=>{b(t=>t.filter(t=>t.id!==e)),m===e&&y(null)},D=(e,t)=>{b(n=>n.map(n=>n.id===e?{...n,stages:n.stages.filter(e=>e.id!==t)}:n))},F=e=>{let t=new c.uE({orientation:"p",unit:"pt",format:"a4"}),n=40;t.setFont("helvetica","bold"),t.setFontSize(14),t.text("قضية: ".concat(e.name),40,n),n+=24,t.setFont("helvetica","normal"),t.setFontSize(11),t.text("تاريخ الإنشاء: ".concat(new Date(e.createdAt).toLocaleString("ar-EG")),40,n),n+=20,(e.stages||[]).forEach((e,o)=>{t.setFont("helvetica","bold"),t.text("".concat(o+1,") ").concat(s[e.stageIndex]),40,n),n+=18,t.setFont("helvetica","normal");let i=t.splitTextToSize("النص: ".concat(e.input),520);t.text(i,40,n),n+=14*i.length+8;let a=t.splitTextToSize("النتيجة: ".concat(e.output),520);t.text(a,40,n),(n+=14*a.length+14)>720&&(t.addPage(),n=40)}),t.save("".concat(e.name,".pdf"))},B=async e=>{let t=[new l.fzL({text:"قضية: ".concat(e.name),heading:l.Fmo.HEADING_2}),new l.fzL({text:"تاريخ الإنشاء: ".concat(new Date(e.createdAt).toLocaleString("ar-EG"))})];(e.stages||[]).forEach((e,n)=>{t.push(new l.fzL({text:"".concat(n+1,") ").concat(s[e.stageIndex]),heading:l.Fmo.HEADING_3})),t.push(new l.fzL({children:[new l.NTc({text:"النص: ".concat(e.input)})]})),t.push(new l.fzL({children:[new l.NTc({text:"النتيجة: ".concat(e.output)})]}))});let n=new l.yoT({sections:[{children:t}]}),o=await l.ND6.toBlob(n),i=URL.createObjectURL(o),a=document.createElement("a");a.href=i,a.download="".concat(e.name,".docx"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)};return(0,o.jsx)("div",{style:{fontFamily:"Tajawal, Arial, sans-serif",direction:"rtl",minHeight:"100vh",background:e.background,color:e.text,padding:0,margin:0,transition:"background 0.4s"},children:n&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("main",{style:{maxWidth:950,width:"100%",margin:"0 auto",padding:(0,r.Fr)()?"1rem 0.5rem":"2.5rem 1rem"},children:[(0,o.jsxs)("div",{style:{background:e.card,borderRadius:14,boxShadow:"0 2px 12px ".concat(e.shadow),border:"1.5px solid ".concat(e.border),padding:(0,r.Fr)()?12:22,marginBottom:28,display:"flex",flexDirection:(0,r.Fr)()?"column":"row",alignItems:"center",gap:14,justifyContent:"center"},children:[(0,o.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="legal_cases.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)},style:{background:"linear-gradient(90deg, ".concat(e.accent2," 0%, ").concat(e.accent," 100%)"),color:"#fff",border:"none",borderRadius:8,padding:"10px 22px",fontWeight:800,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #4f46e522",letterSpacing:1,transition:"background 0.2s"},children:"⬇️ تصدير القضايا"}),(0,o.jsxs)("label",{style:{background:"linear-gradient(90deg, ".concat(e.accent," 0%, ").concat(e.accent2," 100%)"),color:"#fff",borderRadius:8,padding:"10px 22px",fontWeight:800,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #6366f122",display:"inline-block",letterSpacing:1,transition:"background 0.2s"},children:["⬆️ استيراد قضايا",(0,o.jsx)("input",{type:"file",accept:"application/json",onChange:e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];if(!n)return;let o=new FileReader;o.onload=function(e){var t;if("string"==typeof(null==(t=e.target)?void 0:t.result))try{let t=JSON.parse(e.target.result);if(Array.isArray(t)){let e=[...h];t.forEach(t=>{e.some(e=>e.id===t.id)||e.push(t)}),b(e)}else alert("صيغة الملف غير صحيحة!")}catch(e){alert("فشل في قراءة الملف!")}},o.readAsText(n)},style:{display:"none"}})]}),(0,o.jsx)("input",{type:"text",value:k,onChange:e=>z(e.target.value),placeholder:"\uD83D\uDD0D ابحث عن قضية...",style:{flex:1,minWidth:180,maxWidth:320,borderRadius:8,border:"1.5px solid ".concat(e.accent2),padding:"10px 14px",fontSize:15,outline:"none",background:t?"#232946":"#fff",color:e.text,boxShadow:"0 1px 4px #6366f122"}}),(0,o.jsx)("input",{type:"text",value:C,onChange:e=>R(e.target.value),placeholder:"\uD83C\uDFF7️ فلترة بالوسم...",style:{minWidth:180,maxWidth:260,borderRadius:8,border:"1.5px solid ".concat(e.accent2),padding:"10px 14px",fontSize:15,outline:"none",background:t?"#232946":"#fff",color:e.text,boxShadow:"0 1px 4px #6366f122"}})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:10,marginBottom:18},children:[(0,o.jsx)("span",{style:{fontSize:32},children:"\uD83D\uDCD1"}),(0,o.jsx)("h1",{style:{color:e.accent,fontWeight:900,fontSize:28,margin:0,letterSpacing:1},children:"قائمة القضايا"})]}),0===h.length?(0,o.jsx)("div",{style:{textAlign:"center",color:e.accent2,fontSize:18,marginTop:40,background:e.card,borderRadius:12,padding:24,boxShadow:"0 1px 8px ".concat(e.shadow)},children:"لا يوجد قضايا محفوظة بعد."}):m?(0,o.jsxs)("div",{style:{marginBottom:32},children:[(0,o.jsx)("button",{onClick:()=>y(null),style:{marginBottom:18,background:e.accent2,color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 1px 4px #6366f122"},children:"← العودة للقضايا"}),h.filter(e=>e.id===m).map(n=>(0,o.jsxs)("div",{style:{background:e.card,borderRadius:18,boxShadow:"0 2px 16px ".concat(e.shadow),border:"2px solid ".concat(e.accent2),padding:(0,r.Fr)()?14:32,marginBottom:18},children:[(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,flexWrap:"wrap"},children:w===n.id?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"text",value:j,onChange:e=>v(e.target.value),style:{fontWeight:800,fontSize:22,color:e.accent,border:"1.5px solid "+e.accent2,borderRadius:8,padding:"4px 10px",outline:"none",width:(0,r.Fr)()?180:320}}),(0,o.jsx)("button",{onClick:()=>{b(e=>e.map(e=>e.id===n.id?{...e,name:j}:e)),S(null)},style:{background:e.accent2,color:"#fff",border:"none",borderRadius:8,padding:"6px 14px",fontWeight:700,fontSize:15,cursor:"pointer",marginRight:6},children:"حفظ"}),(0,o.jsx)("button",{onClick:()=>S(null),style:{background:"#eee",color:e.accent2,border:"none",borderRadius:8,padding:"6px 14px",fontWeight:700,fontSize:15,cursor:"pointer"},children:"إلغاء"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{style:{fontWeight:900,fontSize:26,color:e.accent},children:n.name}),(0,o.jsx)("button",{onClick:()=>F(n),style:{background:"#ef4444",color:"#fff",border:"none",borderRadius:8,padding:"6px 12px",fontWeight:700,fontSize:14,cursor:"pointer"},children:"تصدير PDF"}),(0,o.jsx)("button",{onClick:()=>B(n),style:{background:"#0ea5e9",color:"#fff",border:"none",borderRadius:8,padding:"6px 12px",fontWeight:700,fontSize:14,cursor:"pointer"},children:"تصدير Word"}),(0,o.jsx)("button",{onClick:()=>{S(n.id),v(n.name)},style:{background:e.accent2,color:"#fff",border:"none",borderRadius:8,padding:"5px 12px",fontWeight:700,fontSize:15,cursor:"pointer",marginRight:8},children:"تعديل الاسم"})]})}),(0,o.jsxs)("div",{style:{fontSize:15,color:"#888",marginBottom:18},children:["تاريخ الإنشاء: ",new Date(n.createdAt).toLocaleString("ar-EG")]}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:18},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,o.jsx)("span",{style:{fontWeight:700,color:e.accent2},children:"وسوم:"}),(0,o.jsx)(u,{c:n,setCases:b,theme:e})]}),n.stages.map(t=>(0,o.jsxs)("div",{style:{background:p.resultBg,borderRadius:12,boxShadow:"0 1px 6px ".concat(e.shadow),border:"1.5px solid ".concat(e.accent2),padding:(0,r.Fr)()?10:18,position:"relative",marginBottom:8},children:[(0,o.jsxs)("div",{style:{color:e.accent2,fontWeight:800,fontSize:17,marginBottom:6},children:[(0,o.jsx)("span",{style:{fontSize:18},children:"\uD83E\uDDE9"})," ",s[t.stageIndex]]}),(0,o.jsx)("div",{style:{fontWeight:600,color:e.accent,marginBottom:4},children:"النص المدخل:"}),(0,o.jsx)("div",{style:{background:f.card,borderRadius:8,padding:"8px 12px",fontSize:16,whiteSpace:"pre-line",border:"1px solid ".concat(e.border),marginBottom:8},children:t.input}),(0,o.jsx)("div",{style:{fontWeight:600,color:e.accent,marginBottom:4},children:"مخرجات التحليل:"}),(0,o.jsx)("div",{style:{background:f.card,borderRadius:8,padding:"8px 12px",fontSize:16,whiteSpace:"pre-line",border:"1px solid ".concat(e.border)},children:t.output}),(0,o.jsxs)("div",{style:{fontSize:13,color:"#888",marginTop:6},children:["تاريخ المرحلة: ",new Date(t.date).toLocaleString("ar-EG")]}),(0,o.jsx)("button",{onClick:()=>D(n.id,t.id),style:{position:"absolute",left:14,top:14,background:"#ff6b6b",color:"#fff",border:"none",borderRadius:8,padding:(0,r.Fr)()?"4px 8px":"5px 12px",fontWeight:700,fontSize:(0,r.Fr)()?12:14,cursor:"pointer",boxShadow:"0 1px 4px #ff6b6b33",transition:"background 0.2s"},children:"حذف المرحلة"})]},t.id)),(0,o.jsx)("div",{style:{marginTop:10},children:(0,o.jsx)("div",{style:{background:p.resultBg,borderRadius:12,boxShadow:"0 1px 6px ".concat(e.shadow),border:"1.5px solid ".concat(e.accent2),padding:(0,r.Fr)()?10:18},children:(0,o.jsx)(g,{caseObj:n,setCases:b,theme:e,darkMode:t})})})]}),(0,o.jsx)("button",{onClick:()=>W(n.id),style:{marginTop:18,background:"#ff6b6b",color:"#fff",border:"none",borderRadius:8,padding:(0,r.Fr)()?"7px 14px":"8px 22px",fontWeight:800,fontSize:(0,r.Fr)()?15:17,cursor:"pointer",boxShadow:"0 1px 4px #ff6b6b33",transition:"background 0.2s"},children:"حذف القضية"})]},n.id))]}):(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:(0,r.Fr)()?"1fr":"1fr 1fr 1fr",gap:24,justifyContent:"center"},children:h.filter(e=>e.name.toLowerCase().includes(k.toLowerCase())).filter(e=>!C.trim()||(e.tags||[]).some(e=>e.toLowerCase().includes(C.toLowerCase()))).map(t=>(0,o.jsxs)("div",{style:{background:e.card,borderRadius:16,boxShadow:"0 2px 12px ".concat(e.shadow),border:"2px solid ".concat(e.accent2),padding:(0,r.Fr)()?12:24,cursor:"pointer",transition:"box-shadow 0.2s, border 0.2s",position:"relative",minHeight:170,display:"flex",flexDirection:"column",justifyContent:"space-between"},onClick:()=>y(t.id),children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{fontWeight:900,fontSize:22,color:e.accent,marginBottom:8,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:t.name}),(0,o.jsxs)("div",{style:{fontSize:14,color:"#888",marginBottom:10},children:["تاريخ الإنشاء: ",new Date(t.createdAt).toLocaleString("ar-EG")]}),(0,o.jsxs)("div",{style:{fontSize:15,color:e.accent2,marginBottom:8},children:["عدد المراحل: ",t.stages.length]}),!!(t.tags&&t.tags.length)&&(0,o.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginTop:6},children:t.tags.map((t,n)=>(0,o.jsxs)("span",{style:{background:"#eef2ff",color:"#4338ca",border:"1px solid ".concat(e.border),borderRadius:6,padding:"2px 6px",fontSize:12},children:["#",t]},n))})]}),(0,o.jsx)("button",{onClick:e=>{e.stopPropagation(),W(t.id)},style:{position:"absolute",left:18,top:18,background:"linear-gradient(90deg, #ff6b6b 0%, #ffb6b6 100%)",color:"#fff",border:"none",borderRadius:8,padding:(0,r.Fr)()?"7px 14px":"8px 18px",fontWeight:800,fontSize:(0,r.Fr)()?14:16,cursor:"pointer",boxShadow:"0 1px 4px #ff6b6b33",transition:"background 0.2s"},children:"حذف"})]},t.id))}),(0,o.jsx)("div",{style:{height:40}}),(0,o.jsxs)("footer",{style:{textAlign:"center",color:"#888",marginTop:32,fontSize:15,borderTop:"1.5px solid ".concat(e.border),paddingTop:18},children:["\xa9 ",new Date().getFullYear()," منصة التحليل القانوني الذكي"]})]})})})}function u(e){let{c:t,setCases:n,theme:a}=e,[r,d]=(0,i.useState)(""),c=t.tags||[],l=e=>{n(n=>n.map(n=>n.id===t.id?{...n,tags:(n.tags||[]).filter(t=>t!==e)}:n))};return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[c.map((e,t)=>(0,o.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:6,background:"#eef2ff",color:"#4338ca",border:"1px solid ".concat(a.border),borderRadius:16,padding:"2px 8px",fontSize:12},children:["#",e,(0,o.jsx)("button",{onClick:()=>l(e),"aria-label":"حذف الوسم ".concat(e),style:{background:"transparent",border:"none",color:"#ef4444",cursor:"pointer"},children:"\xd7"})]},t)),(0,o.jsx)("input",{type:"text",value:r,onChange:e=>d(e.target.value),placeholder:"أضف وسمًا",style:{borderRadius:8,border:"1.5px solid ".concat(a.accent2),padding:"6px 10px",fontSize:13,outline:"none"}}),(0,o.jsx)("button",{onClick:()=>{let e=r.trim();e&&(n(n=>n.map(n=>n.id===t.id?{...n,tags:Array.from(new Set([...n.tags||[],e]))}:n)),d(""))},disabled:!r.trim(),style:{background:a.accent2,color:"#fff",border:"none",borderRadius:8,padding:"6px 10px",fontWeight:700,fontSize:13,cursor:r.trim()?"pointer":"not-allowed"},children:"إضافة"})]})}function g(e){let{caseObj:t,setCases:n,theme:r,darkMode:d}=e,[c,l]=(0,i.useState)(""),[s,p]=(0,i.useState)(!1),[f,x]=(0,i.useState)(null),[u,g]=(0,i.useState)("");(0,i.useEffect)(()=>{(0,a.WL)().then(e=>g(e||""))},[]);let h=async e=>{if(e.preventDefault(),x(null),c.trim()){if(!u)return void x("يرجى إدخال مفتاح Gemini API في الصفحة الرئيسية أولاً.");p(!0);try{let e=await fetch("/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:c,stageIndex:0,apiKey:u})}),o=await e.json();if(e.ok){let e={id:Math.random().toString(36).slice(2),question:c,answer:o.analysis,date:new Date().toISOString()};n(n=>n.map(n=>n.id===t.id?{...n,chats:[...n.chats||[],e]}:n)),l("")}else x(o.error||"حدث خطأ أثناء التحليل")}catch(e){x("تعذر الاتصال بالخادم")}finally{p(!1)}}};return(0,o.jsxs)("div",{style:{marginTop:18,background:d?"#181a2a":"#f5f7ff",borderRadius:12,border:"1px solid ".concat(r.border),padding:14},children:[(0,o.jsx)("div",{style:{fontWeight:700,color:r.accent,marginBottom:8,fontSize:16},children:"\uD83D\uDCAC تحدث مع مخرجات القضية"}),(0,o.jsxs)("form",{onSubmit:h,style:{display:"flex",gap:8,marginBottom:10},children:[(0,o.jsx)("input",{type:"text",value:c,onChange:e=>l(e.target.value),placeholder:"اكتب سؤالك أو استفسارك...",style:{flex:1,borderRadius:8,border:"1.5px solid ".concat(r.accent2),padding:10,fontSize:15,outline:"none",background:d?"#232946":"#fff",color:r.text},disabled:s}),(0,o.jsx)("button",{type:"submit",disabled:s||!c.trim(),style:{background:r.accent2,color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:15,cursor:s?"not-allowed":"pointer"},children:"إرسال"})]}),f&&(0,o.jsx)("div",{style:{color:"#ff6b6b",fontWeight:700,marginBottom:8},children:f}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10,marginTop:8},children:[0===(t.chats||[]).length&&(0,o.jsx)("div",{style:{color:"#888",fontSize:14},children:"لا توجد محادثات بعد."}),(t.chats||[]).map(e=>(0,o.jsxs)("div",{style:{background:d?"#232946":"#fff",borderRadius:8,border:"1px solid ".concat(r.accent2,"22"),padding:10},children:[(0,o.jsx)("div",{style:{fontWeight:700,color:r.accent2,marginBottom:4,fontSize:15},children:"سؤالك:"}),(0,o.jsx)("div",{style:{marginBottom:6,fontSize:15},children:e.question}),(0,o.jsx)("div",{style:{fontWeight:700,color:r.accent,marginBottom:4,fontSize:15},children:"الرد:"}),(0,o.jsx)("div",{style:{fontSize:15,whiteSpace:"pre-line"},children:e.answer}),(0,o.jsxs)("div",{style:{fontSize:12,color:"#888",marginTop:4},children:["بتاريخ: ",new Date(e.date).toLocaleString("ar-EG")]})]},e.id))]})]})}},6670:(e,t,n)=>{"use strict";n.d(t,{Gm:()=>f,I7:()=>m,LF:()=>u,M8:()=>x,Pc:()=>d,WL:()=>c,W_:()=>s,mn:()=>h,qK:()=>p,ub:()=>b,x1:()=>l});var o=n(9703);let i="legal_cases",a="gemini_api_key",r="legal_templates";async function d(e){await (0,o.hZ)(a,e)}async function c(){return await (0,o.Jt)(a)||""}async function l(){return await (0,o.Jt)(i)||[]}async function s(e){await (0,o.hZ)(i,e)}async function p(e){let t=await l();t.unshift(e),await s(t)}async function f(e){let t=await l();t=t.map(t=>t.id===e.id?e:t),await s(t)}async function x(){await (0,o.yH)(i)}async function u(){return await (0,o.Jt)(r)||[]}async function g(e){await (0,o.hZ)(r,e)}async function h(e){let t=await u();t.unshift(e),await g(t)}async function b(e){let t=await u();t=t.map(t=>t.id===e.id?e:t),await g(t)}async function m(e){let t=await u();t=t.filter(t=>t.id!==e),await g(t)}}},e=>{var t=t=>e(e.s=t);e.O(0,[741,347,220,115,636,593,792],()=>t(1540)),_N_E=e.O()}]);