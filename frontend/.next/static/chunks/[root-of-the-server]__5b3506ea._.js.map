{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["turbopack:///[turbopack]/browser/dev/hmr-client/hmr-client.ts"],"sourcesContent":["/// <reference path=\"../../../shared/runtime-types.d.ts\" />\r\n/// <reference path=\"../../runtime/base/dev-globals.d.ts\" />\r\n/// <reference path=\"../../runtime/base/dev-protocol.d.ts\" />\r\n/// <reference path=\"../../runtime/base/dev-extensions.ts\" />\r\n\r\ntype SendMessage = (msg: any) => void;\r\nexport type WebSocketMessage =\r\n  | {\r\n      type: \"turbopack-connected\";\r\n    }\r\n  | {\r\n      type: \"turbopack-message\";\r\n      data: Record<string, any>;\r\n    };\r\n\r\n\r\nexport type ClientOptions = {\r\n  addMessageListener: (cb: (msg: WebSocketMessage) => void) => void;\r\n  sendMessage: SendMessage;\r\n  onUpdateError: (err: unknown) => void;\r\n};\r\n\r\nexport function connect({\r\n  addMessageListener,\r\n  sendMessage,\r\n  onUpdateError = console.error,\r\n}: ClientOptions) {\r\n  addMessageListener((msg) => {\r\n    switch (msg.type) {\r\n      case \"turbopack-connected\":\r\n        handleSocketConnected(sendMessage);\r\n        break;\r\n      default:\r\n        try {\r\n          if (Array.isArray(msg.data)) {\r\n            for (let i = 0; i < msg.data.length; i++) {\r\n              handleSocketMessage(msg.data[i] as ServerMessage);\r\n            }\r\n          } else {\r\n            handleSocketMessage(msg.data as ServerMessage);\r\n          }\r\n          applyAggregatedUpdates();\r\n        } catch (e: unknown) {\r\n          console.warn(\r\n            \"[Fast Refresh] performing full reload\\n\\n\" +\r\n              \"Fast Refresh will perform a full reload when you edit a file that's imported by modules outside of the React rendering tree.\\n\" +\r\n              \"You might have a file which exports a React component but also exports a value that is imported by a non-React component file.\\n\" +\r\n              \"Consider migrating the non-React component export to a separate file and importing it into both files.\\n\\n\" +\r\n              \"It is also possible the parent component of the component you edited is a class component, which disables Fast Refresh.\\n\" +\r\n              \"Fast Refresh requires at least one parent function component in your React tree.\"\r\n          );\r\n          onUpdateError(e);\r\n          location.reload();\r\n        }\r\n        break;\r\n    }\r\n  });\r\n\r\n  const queued = globalThis.TURBOPACK_CHUNK_UPDATE_LISTENERS;\r\n  if (queued != null && !Array.isArray(queued)) {\r\n    throw new Error(\"A separate HMR handler was already registered\");\r\n  }\r\n  globalThis.TURBOPACK_CHUNK_UPDATE_LISTENERS = {\r\n    push: ([chunkPath, callback]: [ChunkListPath, UpdateCallback]) => {\r\n      subscribeToChunkUpdate(chunkPath, sendMessage, callback);\r\n    },\r\n  };\r\n\r\n  if (Array.isArray(queued)) {\r\n    for (const [chunkPath, callback] of queued) {\r\n      subscribeToChunkUpdate(chunkPath, sendMessage, callback);\r\n    }\r\n  }\r\n}\r\n\r\ntype UpdateCallbackSet = {\r\n  callbacks: Set<UpdateCallback>;\r\n  unsubscribe: () => void;\r\n};\r\n\r\nconst updateCallbackSets: Map<ResourceKey, UpdateCallbackSet> = new Map();\r\n\r\nfunction sendJSON(sendMessage: SendMessage, message: ClientMessage) {\r\n  sendMessage(JSON.stringify(message));\r\n}\r\n\r\ntype ResourceKey = string;\r\n\r\nfunction resourceKey(resource: ResourceIdentifier): ResourceKey {\r\n  return JSON.stringify({\r\n    path: resource.path,\r\n    headers: resource.headers || null,\r\n  });\r\n}\r\n\r\nfunction subscribeToUpdates(\r\n  sendMessage: SendMessage,\r\n  resource: ResourceIdentifier\r\n): () => void {\r\n  sendJSON(sendMessage, {\r\n    type: \"turbopack-subscribe\",\r\n    ...resource,\r\n  });\r\n\r\n  return () => {\r\n    sendJSON(sendMessage, {\r\n      type: \"turbopack-unsubscribe\",\r\n      ...resource,\r\n    });\r\n  };\r\n}\r\n\r\nfunction handleSocketConnected(sendMessage: SendMessage) {\r\n  for (const key of updateCallbackSets.keys()) {\r\n    subscribeToUpdates(sendMessage, JSON.parse(key));\r\n  }\r\n}\r\n\r\n// we aggregate all pending updates until the issues are resolved\r\nconst chunkListsWithPendingUpdates: Map<ResourceKey, PartialServerMessage> =\r\n  new Map();\r\n\r\nfunction aggregateUpdates(msg: PartialServerMessage) {\r\n  const key = resourceKey(msg.resource);\r\n  let aggregated = chunkListsWithPendingUpdates.get(key);\r\n\r\n  if (aggregated) {\r\n    aggregated.instruction = mergeChunkListUpdates(\r\n      aggregated.instruction,\r\n      msg.instruction\r\n    );\r\n  } else {\r\n    chunkListsWithPendingUpdates.set(key, msg);\r\n  }\r\n}\r\n\r\nfunction applyAggregatedUpdates() {\r\n  if (chunkListsWithPendingUpdates.size === 0) return;\r\n  hooks.beforeRefresh();\r\n  for (const msg of chunkListsWithPendingUpdates.values()) {\r\n    triggerUpdate(msg);\r\n  }\r\n  chunkListsWithPendingUpdates.clear();\r\n  finalizeUpdate();\r\n}\r\n\r\nfunction mergeChunkListUpdates(\r\n  updateA: ChunkListUpdate,\r\n  updateB: ChunkListUpdate\r\n): ChunkListUpdate {\r\n  let chunks;\r\n  if (updateA.chunks != null) {\r\n    if (updateB.chunks == null) {\r\n      chunks = updateA.chunks;\r\n    } else {\r\n      chunks = mergeChunkListChunks(updateA.chunks, updateB.chunks);\r\n    }\r\n  } else if (updateB.chunks != null) {\r\n    chunks = updateB.chunks;\r\n  }\r\n\r\n  let merged;\r\n  if (updateA.merged != null) {\r\n    if (updateB.merged == null) {\r\n      merged = updateA.merged;\r\n    } else {\r\n      // Since `merged` is an array of updates, we need to merge them all into\r\n      // one, consistent update.\r\n      // Since there can only be `EcmascriptMergeUpdates` in the array, there is\r\n      // no need to key on the `type` field.\r\n      let update = updateA.merged[0];\r\n      for (let i = 1; i < updateA.merged.length; i++) {\r\n        update = mergeChunkListEcmascriptMergedUpdates(\r\n          update,\r\n          updateA.merged[i]\r\n        );\r\n      }\r\n\r\n      for (let i = 0; i < updateB.merged.length; i++) {\r\n        update = mergeChunkListEcmascriptMergedUpdates(\r\n          update,\r\n          updateB.merged[i]\r\n        );\r\n      }\r\n\r\n      merged = [update];\r\n    }\r\n  } else if (updateB.merged != null) {\r\n    merged = updateB.merged;\r\n  }\r\n\r\n  return {\r\n    type: \"ChunkListUpdate\",\r\n    chunks,\r\n    merged,\r\n  };\r\n}\r\n\r\nfunction mergeChunkListChunks(\r\n  chunksA: Record<ChunkPath, ChunkUpdate>,\r\n  chunksB: Record<ChunkPath, ChunkUpdate>\r\n): Record<ChunkPath, ChunkUpdate> {\r\n  const chunks: Record<ChunkPath, ChunkUpdate> = {};\r\n\r\n  for (const [chunkPath, chunkUpdateA] of Object.entries(chunksA) as Array<[ChunkPath, ChunkUpdate]>) {\r\n    const chunkUpdateB = chunksB[chunkPath];\r\n    if (chunkUpdateB != null) {\r\n      const mergedUpdate = mergeChunkUpdates(chunkUpdateA, chunkUpdateB);\r\n      if (mergedUpdate != null) {\r\n        chunks[chunkPath] = mergedUpdate;\r\n      }\r\n    } else {\r\n      chunks[chunkPath] = chunkUpdateA;\r\n    }\r\n  }\r\n\r\n  for (const [chunkPath, chunkUpdateB] of Object.entries(chunksB) as Array<[ChunkPath, ChunkUpdate]>) {\r\n    if (chunks[chunkPath] == null) {\r\n      chunks[chunkPath] = chunkUpdateB;\r\n    }\r\n  }\r\n\r\n  return chunks;\r\n}\r\n\r\nfunction mergeChunkUpdates(\r\n  updateA: ChunkUpdate,\r\n  updateB: ChunkUpdate\r\n): ChunkUpdate | undefined {\r\n  if (\r\n    (updateA.type === \"added\" && updateB.type === \"deleted\") ||\r\n    (updateA.type === \"deleted\" && updateB.type === \"added\")\r\n  ) {\r\n    return undefined;\r\n  }\r\n\r\n  if (updateA.type === \"partial\") {\r\n    invariant(updateA.instruction, \"Partial updates are unsupported\");\r\n  }\r\n\r\n  if (updateB.type === \"partial\") {\r\n    invariant(updateB.instruction, \"Partial updates are unsupported\");\r\n  }\r\n\r\n  return undefined;\r\n}\r\n\r\nfunction mergeChunkListEcmascriptMergedUpdates(\r\n  mergedA: EcmascriptMergedUpdate,\r\n  mergedB: EcmascriptMergedUpdate\r\n): EcmascriptMergedUpdate {\r\n  const entries = mergeEcmascriptChunkEntries(mergedA.entries, mergedB.entries);\r\n  const chunks = mergeEcmascriptChunksUpdates(mergedA.chunks, mergedB.chunks);\r\n\r\n  return {\r\n    type: \"EcmascriptMergedUpdate\",\r\n    entries,\r\n    chunks,\r\n  };\r\n}\r\n\r\nfunction mergeEcmascriptChunkEntries(\r\n  entriesA: Record<ModuleId, EcmascriptModuleEntry> | undefined,\r\n  entriesB: Record<ModuleId, EcmascriptModuleEntry> | undefined\r\n): Record<ModuleId, EcmascriptModuleEntry> {\r\n  return { ...entriesA, ...entriesB };\r\n}\r\n\r\nfunction mergeEcmascriptChunksUpdates(\r\n  chunksA: Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined,\r\n  chunksB: Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined\r\n): Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined {\r\n  if (chunksA == null) {\r\n    return chunksB;\r\n  }\r\n\r\n  if (chunksB == null) {\r\n    return chunksA;\r\n  }\r\n\r\n  const chunks: Record<ChunkPath, EcmascriptMergedChunkUpdate> = {};\r\n\r\n  for (const [chunkPath, chunkUpdateA] of Object.entries(chunksA) as Array<[ChunkPath, EcmascriptMergedChunkUpdate]>) {\r\n    const chunkUpdateB = chunksB[chunkPath];\r\n    if (chunkUpdateB != null) {\r\n      const mergedUpdate = mergeEcmascriptChunkUpdates(\r\n        chunkUpdateA,\r\n        chunkUpdateB\r\n      );\r\n      if (mergedUpdate != null) {\r\n        chunks[chunkPath] = mergedUpdate;\r\n      }\r\n    } else {\r\n      chunks[chunkPath] = chunkUpdateA;\r\n    }\r\n  }\r\n\r\n  for (const [chunkPath, chunkUpdateB] of Object.entries(chunksB) as Array<[ChunkPath, EcmascriptMergedChunkUpdate]>) {\r\n    if (chunks[chunkPath] == null) {\r\n      chunks[chunkPath] = chunkUpdateB;\r\n    }\r\n  }\r\n\r\n  if (Object.keys(chunks).length === 0) {\r\n    return undefined;\r\n  }\r\n\r\n  return chunks;\r\n}\r\n\r\nfunction mergeEcmascriptChunkUpdates(\r\n  updateA: EcmascriptMergedChunkUpdate,\r\n  updateB: EcmascriptMergedChunkUpdate\r\n): EcmascriptMergedChunkUpdate | undefined {\r\n  if (updateA.type === \"added\" && updateB.type === \"deleted\") {\r\n    // These two completely cancel each other out.\r\n    return undefined;\r\n  }\r\n\r\n  if (updateA.type === \"deleted\" && updateB.type === \"added\") {\r\n    const added = [];\r\n    const deleted = [];\r\n    const deletedModules = new Set(updateA.modules ?? []);\r\n    const addedModules = new Set(updateB.modules ?? []);\r\n\r\n    for (const moduleId of addedModules) {\r\n      if (!deletedModules.has(moduleId)) {\r\n        added.push(moduleId);\r\n      }\r\n    }\r\n\r\n    for (const moduleId of deletedModules) {\r\n      if (!addedModules.has(moduleId)) {\r\n        deleted.push(moduleId);\r\n      }\r\n    }\r\n\r\n    if (added.length === 0 && deleted.length === 0) {\r\n      return undefined;\r\n    }\r\n\r\n    return {\r\n      type: \"partial\",\r\n      added,\r\n      deleted,\r\n    };\r\n  }\r\n\r\n  if (updateA.type === \"partial\" && updateB.type === \"partial\") {\r\n    const added = new Set([...(updateA.added ?? []), ...(updateB.added ?? [])]);\r\n    const deleted = new Set([\r\n      ...(updateA.deleted ?? []),\r\n      ...(updateB.deleted ?? []),\r\n    ]);\r\n\r\n    if (updateB.added != null) {\r\n      for (const moduleId of updateB.added) {\r\n        deleted.delete(moduleId);\r\n      }\r\n    }\r\n\r\n    if (updateB.deleted != null) {\r\n      for (const moduleId of updateB.deleted) {\r\n        added.delete(moduleId);\r\n      }\r\n    }\r\n\r\n    return {\r\n      type: \"partial\",\r\n      added: [...added],\r\n      deleted: [...deleted],\r\n    };\r\n  }\r\n\r\n  if (updateA.type === \"added\" && updateB.type === \"partial\") {\r\n    const modules = new Set([\r\n      ...(updateA.modules ?? []),\r\n      ...(updateB.added ?? []),\r\n    ]);\r\n\r\n    for (const moduleId of updateB.deleted ?? []) {\r\n      modules.delete(moduleId);\r\n    }\r\n\r\n    return {\r\n      type: \"added\",\r\n      modules: [...modules],\r\n    };\r\n  }\r\n\r\n  if (updateA.type === \"partial\" && updateB.type === \"deleted\") {\r\n    // We could eagerly return `updateB` here, but this would potentially be\r\n    // incorrect if `updateA` has added modules.\r\n\r\n    const modules = new Set(updateB.modules ?? []);\r\n\r\n    if (updateA.added != null) {\r\n      for (const moduleId of updateA.added) {\r\n        modules.delete(moduleId);\r\n      }\r\n    }\r\n\r\n    return {\r\n      type: \"deleted\",\r\n      modules: [...modules],\r\n    };\r\n  }\r\n\r\n  // Any other update combination is invalid.\r\n\r\n  return undefined;\r\n}\r\n\r\nfunction invariant(_: never, message: string): never {\r\n  throw new Error(`Invariant: ${message}`);\r\n}\r\n\r\nconst CRITICAL = [\"bug\", \"error\", \"fatal\"];\r\n\r\nfunction compareByList(list: any[], a: any, b: any) {\r\n  const aI = list.indexOf(a) + 1 || list.length;\r\n  const bI = list.indexOf(b) + 1 || list.length;\r\n  return aI - bI;\r\n}\r\n\r\nconst chunksWithIssues: Map<ResourceKey, Issue[]> = new Map();\r\n\r\nfunction emitIssues() {\r\n  const issues = [];\r\n  const deduplicationSet = new Set();\r\n\r\n  for (const [_, chunkIssues] of chunksWithIssues) {\r\n    for (const chunkIssue of chunkIssues) {\r\n      if (deduplicationSet.has(chunkIssue.formatted)) continue;\r\n\r\n      issues.push(chunkIssue);\r\n      deduplicationSet.add(chunkIssue.formatted);\r\n    }\r\n  }\r\n\r\n  sortIssues(issues);\r\n\r\n  hooks.issues(issues);\r\n}\r\n\r\nfunction handleIssues(msg: ServerMessage): boolean {\r\n  const key = resourceKey(msg.resource);\r\n  let hasCriticalIssues = false;\r\n\r\n  for (const issue of msg.issues) {\r\n    if (CRITICAL.includes(issue.severity)) {\r\n      hasCriticalIssues = true;\r\n    }\r\n  }\r\n\r\n  if (msg.issues.length > 0) {\r\n    chunksWithIssues.set(key, msg.issues);\r\n  } else if (chunksWithIssues.has(key)) {\r\n    chunksWithIssues.delete(key);\r\n  }\r\n\r\n  emitIssues();\r\n\r\n  return hasCriticalIssues;\r\n}\r\n\r\nconst SEVERITY_ORDER = [\"bug\", \"fatal\", \"error\", \"warning\", \"info\", \"log\"];\r\nconst CATEGORY_ORDER = [\r\n  \"parse\",\r\n  \"resolve\",\r\n  \"code generation\",\r\n  \"rendering\",\r\n  \"typescript\",\r\n  \"other\",\r\n];\r\n\r\nfunction sortIssues(issues: Issue[]) {\r\n  issues.sort((a, b) => {\r\n    const first = compareByList(SEVERITY_ORDER, a.severity, b.severity);\r\n    if (first !== 0) return first;\r\n    return compareByList(CATEGORY_ORDER, a.category, b.category);\r\n  });\r\n}\r\n\r\nconst hooks = {\r\n  beforeRefresh: () => {},\r\n  refresh: () => {},\r\n  buildOk: () => {},\r\n  issues: (_issues: Issue[]) => {},\r\n};\r\n\r\nexport function setHooks(newHooks: typeof hooks) {\r\n  Object.assign(hooks, newHooks);\r\n}\r\n\r\nfunction handleSocketMessage(msg: ServerMessage) {\r\n  sortIssues(msg.issues);\r\n\r\n  handleIssues(msg);\r\n\r\n  switch (msg.type) {\r\n    case \"issues\":\r\n      // issues are already handled\r\n      break;\r\n    case \"partial\":\r\n      // aggregate updates\r\n      aggregateUpdates(msg);\r\n      break;\r\n    default:\r\n      // run single update\r\n      const runHooks = chunkListsWithPendingUpdates.size === 0;\r\n      if (runHooks) hooks.beforeRefresh();\r\n      triggerUpdate(msg);\r\n      if (runHooks) finalizeUpdate();\r\n      break;\r\n  }\r\n}\r\n\r\nfunction finalizeUpdate() {\r\n  hooks.refresh();\r\n  hooks.buildOk();\r\n\r\n  // This is used by the Next.js integration test suite to notify it when HMR\r\n  // updates have been completed.\r\n  // TODO: Only run this in test environments (gate by `process.env.__NEXT_TEST_MODE`)\r\n  if (globalThis.__NEXT_HMR_CB) {\r\n    globalThis.__NEXT_HMR_CB();\r\n    globalThis.__NEXT_HMR_CB = null;\r\n  }\r\n}\r\n\r\nfunction subscribeToChunkUpdate(\r\n  chunkListPath: ChunkListPath,\r\n  sendMessage: SendMessage,\r\n  callback: UpdateCallback\r\n): () => void {\r\n  return subscribeToUpdate(\r\n    {\r\n      path: chunkListPath,\r\n    },\r\n    sendMessage,\r\n    callback\r\n  );\r\n}\r\n\r\nexport function subscribeToUpdate(\r\n  resource: ResourceIdentifier,\r\n  sendMessage: SendMessage,\r\n  callback: UpdateCallback\r\n) {\r\n  const key = resourceKey(resource);\r\n  let callbackSet: UpdateCallbackSet;\r\n  const existingCallbackSet = updateCallbackSets.get(key);\r\n  if (!existingCallbackSet) {\r\n    callbackSet = {\r\n      callbacks: new Set([callback]),\r\n      unsubscribe: subscribeToUpdates(sendMessage, resource),\r\n    };\r\n    updateCallbackSets.set(key, callbackSet);\r\n  } else {\r\n    existingCallbackSet.callbacks.add(callback);\r\n    callbackSet = existingCallbackSet;\r\n  }\r\n\r\n  return () => {\r\n    callbackSet.callbacks.delete(callback);\r\n\r\n    if (callbackSet.callbacks.size === 0) {\r\n      callbackSet.unsubscribe();\r\n      updateCallbackSets.delete(key);\r\n    }\r\n  };\r\n}\r\n\r\nfunction triggerUpdate(msg: ServerMessage) {\r\n  const key = resourceKey(msg.resource);\r\n  const callbackSet = updateCallbackSets.get(key);\r\n  if (!callbackSet) {\r\n    return;\r\n  }\r\n\r\n  for (const callback of callbackSet.callbacks) {\r\n    callback(msg);\r\n  }\r\n\r\n  if (msg.type === \"notFound\") {\r\n    // This indicates that the resource which we subscribed to either does not exist or\r\n    // has been deleted. In either case, we should clear all update callbacks, so if a\r\n    // new subscription is created for the same resource, it will send a new \"subscribe\"\r\n    // message to the server.\r\n    // No need to send an \"unsubscribe\" message to the server, it will have already\r\n    // dropped the update stream before sending the \"notFound\" message.\r\n    updateCallbackSets.delete(key);\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 469, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Documents/GitHub/legal_analysis-nextjs/frontend/utils/db.ts"],"sourcesContent":["import { set, get, del } from 'idb-keyval';\r\n\r\n// أنواع البيانات\r\nexport interface AnalysisStage {\r\n  id: string;\r\n  stageIndex: number;\r\n  stage: string;\r\n  input: string;\r\n  output: string;\r\n  date: string;\r\n}\r\n\r\nexport interface LegalCase {\r\n  id: string;\r\n  name: string;\r\n  createdAt: string;\r\n  stages: AnalysisStage[];\r\n  tags?: string[];\r\n}\r\n\r\nexport interface LegalTemplate {\r\n  id: string;\r\n  name: string;\r\n  content: string; // يحتوي نص القالب مع متغيرات {{caseName}} {{stageSummaries}}\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n// مفاتيح التخزين\r\nconst CASES_KEY = 'legal_cases';\r\nconst API_KEY = 'gemini_api_key';\r\nconst TEMPLATES_KEY = 'legal_templates';\r\n\r\n// دوال مفتاح API\r\nexport async function saveApiKey(apiKey: string) {\r\n  await set(API_KEY, apiKey);\r\n}\r\n\r\nexport async function loadApiKey(): Promise<string> {\r\n  return (await get(API_KEY)) || '';\r\n}\r\n\r\n// دوال CRUD للقضايا\r\nexport async function getAllCases(): Promise<LegalCase[]> {\r\n  return (await get(CASES_KEY)) || [];\r\n}\r\n\r\nexport async function saveAllCases(cases: LegalCase[]) {\r\n  await set(CASES_KEY, cases);\r\n}\r\n\r\nexport async function addCase(newCase: LegalCase): Promise<void> {\r\n  const cases = await getAllCases();\r\n  cases.unshift(newCase);\r\n  await saveAllCases(cases);\r\n}\r\n\r\nexport async function updateCase(updatedCase: LegalCase): Promise<void> {\r\n  let cases = await getAllCases();\r\n  cases = cases.map(c => c.id === updatedCase.id ? updatedCase : c);\r\n  await saveAllCases(cases);\r\n}\r\n\r\nexport async function deleteCase(caseId: string): Promise<void> {\r\n  let cases = await getAllCases();\r\n  cases = cases.filter(c => c.id !== caseId);\r\n  await saveAllCases(cases);\r\n}\r\n\r\nexport async function getCaseById(caseId: string): Promise<LegalCase | undefined> {\r\n  const cases = await getAllCases();\r\n  return cases.find(c => c.id === caseId);\r\n}\r\n\r\n// دوال إدارة المراحل داخل قضية\r\nexport async function addStageToCase(caseId: string, stage: AnalysisStage): Promise<void> {\r\n  const cases = await getAllCases();\r\n  const idx = cases.findIndex(c => c.id === caseId);\r\n  if (idx === -1) return;\r\n  cases[idx].stages.push(stage);\r\n  await saveAllCases(cases);\r\n}\r\n\r\nexport async function updateStageInCase(caseId: string, stage: AnalysisStage): Promise<void> {\r\n  const cases = await getAllCases();\r\n  const idx = cases.findIndex(c => c.id === caseId);\r\n  if (idx === -1) return;\r\n  cases[idx].stages = cases[idx].stages.map(s => s.id === stage.id ? stage : s);\r\n  await saveAllCases(cases);\r\n}\r\n\r\nexport async function deleteStageFromCase(caseId: string, stageId: string): Promise<void> {\r\n  const cases = await getAllCases();\r\n  const idx = cases.findIndex(c => c.id === caseId);\r\n  if (idx === -1) return;\r\n  cases[idx].stages = cases[idx].stages.filter(s => s.id !== stageId);\r\n  await saveAllCases(cases);\r\n}\r\n\r\n// دالة حذف جميع القضايا\r\nexport async function clearAllCases() {\r\n  await del(CASES_KEY);\r\n}\r\n\r\n// قوالب قانونية - CRUD\r\nexport async function getAllTemplates(): Promise<LegalTemplate[]> {\r\n  return (await get(TEMPLATES_KEY)) || [];\r\n}\r\n\r\nexport async function saveAllTemplates(templates: LegalTemplate[]): Promise<void> {\r\n  await set(TEMPLATES_KEY, templates);\r\n}\r\n\r\nexport async function addTemplate(t: LegalTemplate): Promise<void> {\r\n  const list = await getAllTemplates();\r\n  list.unshift(t);\r\n  await saveAllTemplates(list);\r\n}\r\n\r\nexport async function updateTemplate(t: LegalTemplate): Promise<void> {\r\n  let list = await getAllTemplates();\r\n  list = list.map(x => x.id === t.id ? t : x);\r\n  await saveAllTemplates(list);\r\n}\r\n\r\nexport async function deleteTemplate(id: string): Promise<void> {\r\n  let list = await getAllTemplates();\r\n  list = list.filter(x => x.id !== id);\r\n  await saveAllTemplates(list);\r\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 579, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Documents/GitHub/legal_analysis-nextjs/frontend/utils/crypto.ts"],"sourcesContent":["import CryptoJS from \"crypto-js\";\r\n\r\nconst SECRET = process.env.NEXT_PUBLIC_ENCRYPTION_SECRET!;\r\n\r\nexport function encrypt(text: string) {\r\n  return CryptoJS.AES.encrypt(text, SECRET).toString();\r\n}\r\n\r\nexport function decrypt(cipher: string) {\r\n  return CryptoJS.AES.decrypt(cipher, SECRET).toString(CryptoJS.enc.Utf8);\r\n}\r\n\r\n// دالة مساعدة لمعرفة إذا كان العرض صغير (جوال)\r\nexport function isMobile() {\r\n  if (typeof window === 'undefined') return false;\r\n  return window.innerWidth <= 768; // زيادة الحد ليشمل المزيد من الأجهزة\r\n}\r\n\r\n// دالة أكثر دقة لمعرفة حجم الشاشة\r\nexport function getScreenSize() {\r\n  if (typeof window === 'undefined') return 'desktop';\r\n  const width = window.innerWidth;\r\n  if (width <= 480) return 'mobile';\r\n  if (width <= 768) return 'tablet';\r\n  if (width <= 1024) return 'small-desktop';\r\n  return 'desktop';\r\n}\r\n\r\n// دالة للتحقق من أن الشاشة صغيرة جداً\r\nexport function isSmallScreen() {\r\n  if (typeof window === 'undefined') return false;\r\n  return window.innerWidth <= 480;\r\n} "],"names":[],"mappings":";;;;;;;AAEe;AAFf;;AAEA,MAAM,SAAS,yJAAA,CAAA,UAAO,CAAC,GAAG,CAAC,6BAA6B;AAEjD,SAAS,QAAQ,IAAY;IAClC,OAAO,iIAAA,CAAA,UAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,QAAQ,QAAQ;AACpD;AAEO,SAAS,QAAQ,MAAc;IACpC,OAAO,iIAAA,CAAA,UAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,QAAQ,QAAQ,CAAC,iIAAA,CAAA,UAAQ,CAAC,GAAG,CAAC,IAAI;AACxE;AAGO,SAAS;IACd,uCAAmC;;IAAY;IAC/C,OAAO,OAAO,UAAU,IAAI,KAAK,qCAAqC;AACxE;AAGO,SAAS;IACd,uCAAmC;;IAAgB;IACnD,MAAM,QAAQ,OAAO,UAAU;IAC/B,IAAI,SAAS,KAAK,OAAO;IACzB,IAAI,SAAS,KAAK,OAAO;IACzB,IAAI,SAAS,MAAM,OAAO;IAC1B,OAAO;AACT;AAGO,SAAS;IACd,uCAAmC;;IAAY;IAC/C,OAAO,OAAO,UAAU,IAAI;AAC9B","debugId":null}},
    {"offset": {"line": 627, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Documents/GitHub/legal_analysis-nextjs/frontend/utils/theme.ts"],"sourcesContent":["export type Theme = {\r\n  background: string;\r\n  card: string;\r\n  border: string;\r\n  input: string;\r\n  text: string;\r\n  accent: string;\r\n  accent2: string;\r\n  resultBg: string;\r\n  errorBg: string;\r\n  errorText: string;\r\n  shadow: string;\r\n};\r\n\r\nexport const lightTheme: Theme = {\r\n  background: 'linear-gradient(135deg, #e0e7ff 0%, #f7f7fa 100%)',\r\n  card: '#fff',\r\n  border: '#e0e7ff',\r\n  input: '#c7d2fe',\r\n  text: '#222',\r\n  accent: '#4f46e5',\r\n  accent2: '#6366f1',\r\n  resultBg: 'linear-gradient(135deg, #f5f7ff 0%, #e0e7ff 100%)',\r\n  errorBg: '#fff0f0',\r\n  errorText: '#e53e3e',\r\n  shadow: '#6366f122',\r\n};\r\n\r\nexport const darkTheme: Theme = {\r\n  background: 'linear-gradient(135deg, #232946 0%, #16161a 100%)',\r\n  card: '#232946',\r\n  border: '#393e5c',\r\n  input: '#393e5c',\r\n  text: '#f7f7fa',\r\n  accent: '#a3a8f0',\r\n  accent2: '#6366f1',\r\n  resultBg: 'linear-gradient(135deg, #232946 0%, #393e5c 100%)',\r\n  errorBg: '#3a1a1a',\r\n  errorText: '#ff6b6b',\r\n  shadow: '#23294655',\r\n}; "],"names":[],"mappings":";;;;AAcO,MAAM,aAAoB;IAC/B,YAAY;IACZ,MAAM;IACN,QAAQ;IACR,OAAO;IACP,MAAM;IACN,QAAQ;IACR,SAAS;IACT,UAAU;IACV,SAAS;IACT,WAAW;IACX,QAAQ;AACV;AAEO,MAAM,YAAmB;IAC9B,YAAY;IACZ,MAAM;IACN,QAAQ;IACR,OAAO;IACP,MAAM;IACN,QAAQ;IACR,SAAS;IACT,UAAU;IACV,SAAS;IACT,WAAW;IACX,QAAQ;AACV","debugId":null}},
    {"offset": {"line": 666, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Documents/GitHub/legal_analysis-nextjs/frontend/contexts/ThemeContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { get as idbGet, set as idbSet } from 'idb-keyval';\r\nimport { Theme, lightTheme, darkTheme } from '../utils/theme';\r\n\r\ninterface ThemeContextValue {\r\n  darkMode: boolean;\r\n  setDarkMode: (value: boolean) => void;\r\n  theme: Theme;\r\n  mounted: boolean;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextValue | undefined>(undefined);\r\n\r\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\r\n  const [darkMode, setDarkMode] = useState<boolean>(false);\r\n  const [mounted, setMounted] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    idbGet('legal_dark_mode').then((savedTheme: string | undefined) => {\r\n      if (!isMounted) return;\r\n      if (savedTheme === '1') setDarkMode(true);\r\n      setMounted(true);\r\n    });\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n    idbSet('legal_dark_mode', darkMode ? '1' : '0');\r\n  }, [darkMode, mounted]);\r\n\r\n  const theme = useMemo<Theme>(() => (darkMode ? darkTheme : lightTheme), [darkMode]);\r\n\r\n  const value = useMemo<ThemeContextValue>(() => ({ darkMode, setDarkMode, theme, mounted }), [darkMode, theme, mounted]);\r\n\r\n  return (\r\n    <ThemeContext.Provider value={value}>\r\n      {children}\r\n    </ThemeContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useTheme() {\r\n  const ctx = useContext(ThemeContext);\r\n  if (!ctx) throw new Error('useTheme must be used within ThemeProvider');\r\n  return ctx;\r\n} "],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;;AASA,MAAM,6BAAe,CAAA,GAAA,0HAAA,CAAA,gBAAa,AAAD,EAAiC;AAE3D,SAAS,cAAc,EAAE,QAAQ,EAAiC;;IACvE,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,0HAAA,CAAA,WAAQ,AAAD,EAAW;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,0HAAA,CAAA,WAAQ,AAAD,EAAW;IAEhD,CAAA,GAAA,0HAAA,CAAA,YAAS,AAAD;mCAAE;YACR,IAAI,YAAY;YAChB,CAAA,GAAA,0IAAA,CAAA,MAAM,AAAD,EAAE,mBAAmB,IAAI;2CAAC,CAAC;oBAC9B,IAAI,CAAC,WAAW;oBAChB,IAAI,eAAe,KAAK,YAAY;oBACpC,WAAW;gBACb;;YACA;2CAAO;oBACL,YAAY;gBACd;;QACF;kCAAG,EAAE;IAEL,CAAA,GAAA,0HAAA,CAAA,YAAS,AAAD;mCAAE;YACR,IAAI,CAAC,SAAS;YACd,CAAA,GAAA,0IAAA,CAAA,MAAM,AAAD,EAAE,mBAAmB,WAAW,MAAM;QAC7C;kCAAG;QAAC;QAAU;KAAQ;IAEtB,MAAM,QAAQ,CAAA,GAAA,0HAAA,CAAA,UAAO,AAAD;wCAAS,IAAO,WAAW,0GAAA,CAAA,YAAS,GAAG,0GAAA,CAAA,aAAU;uCAAG;QAAC;KAAS;IAElF,MAAM,QAAQ,CAAA,GAAA,0HAAA,CAAA,UAAO,AAAD;wCAAqB,IAAM,CAAC;gBAAE;gBAAU;gBAAa;gBAAO;YAAQ,CAAC;uCAAG;QAAC;QAAU;QAAO;KAAQ;IAEtH,qBACE,0JAAC,aAAa,QAAQ;QAAC,OAAO;kBAC3B;;;;;;AAGP;GA9BgB;KAAA;AAgCT,SAAS;;IACd,MAAM,MAAM,CAAA,GAAA,0HAAA,CAAA,aAAU,AAAD,EAAE;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT;IAJgB","debugId":null}},
    {"offset": {"line": 756, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Documents/GitHub/legal_analysis-nextjs/frontend/components/WelcomeHeader.tsx"],"sourcesContent":["import React from 'react';\r\nimport Link from 'next/link';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\n\r\ninterface User {\r\n  username: string;\r\n  role: string;\r\n  officeId: string;\r\n}\r\n\r\ninterface WelcomeHeaderProps {\r\n  user: User;\r\n  onLogout: () => void;\r\n}\r\n\r\nexport default function WelcomeHeader({ user, onLogout }: WelcomeHeaderProps) {\r\n  const { theme } = useTheme();\r\n\r\n  return (\r\n    <div style={{\r\n      background: `linear-gradient(135deg, ${theme.accent} 0%, ${theme.accent2} 100%)`,\r\n      borderRadius: 16,\r\n      padding: '20px',\r\n      marginBottom: 24,\r\n      boxShadow: `0 4px 20px ${theme.accent}33`,\r\n      border: `1px solid ${theme.accent}`,\r\n      color: '#fff',\r\n      textAlign: 'center'\r\n    }}>\r\n      <div style={{fontSize: 24, fontWeight: 800, marginBottom: 8}}>\r\n        🎉 مرحباً بك، {user.username}!\r\n      </div>\r\n      <div style={{fontSize: 16, opacity: 0.9, marginBottom: 16}}>\r\n        {user.role === 'admin' ? 'مدير مكتب' : 'موظف'} في {user.officeId}\r\n      </div>\r\n      <div style={{display: 'flex', gap: 12, justifyContent: 'center', flexWrap: 'wrap'}}>\r\n        <Link href=\"/dashboard\" style={{ textDecoration: 'none' }}>\r\n          <button style={{\r\n            background: 'rgba(255,255,255,0.2)',\r\n            color: '#fff',\r\n            border: '2px solid rgba(255,255,255,0.3)',\r\n            borderRadius: 8,\r\n            padding: '8px 16px',\r\n            fontSize: 14,\r\n            fontWeight: 600,\r\n            cursor: 'pointer',\r\n            transition: 'all 0.3s ease'\r\n          }}>\r\n            🏢 لوحة التحكم\r\n          </button>\r\n        </Link>\r\n        <button\r\n          onClick={onLogout}\r\n          style={{\r\n            background: 'rgba(239,68,68,0.2)',\r\n            color: '#fff',\r\n            border: '2px solid rgba(239,68,68,0.3)',\r\n            borderRadius: 8,\r\n            padding: '8px 16px',\r\n            fontSize: 14,\r\n            fontWeight: 600,\r\n            cursor: 'pointer',\r\n            transition: 'all 0.3s ease'\r\n          }}\r\n        >\r\n          🚪 تسجيل الخروج\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;AACA;AACA;;;;;AAae,SAAS,cAAc,EAAE,IAAI,EAAE,QAAQ,EAAsB;;IAC1E,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;IAEzB,qBACE,0JAAC;QAAI,OAAO;YACV,YAAY,CAAC,wBAAwB,EAAE,MAAM,MAAM,CAAC,KAAK,EAAE,MAAM,OAAO,CAAC,MAAM,CAAC;YAChF,cAAc;YACd,SAAS;YACT,cAAc;YACd,WAAW,CAAC,WAAW,EAAE,MAAM,MAAM,CAAC,EAAE,CAAC;YACzC,QAAQ,CAAC,UAAU,EAAE,MAAM,MAAM,EAAE;YACnC,OAAO;YACP,WAAW;QACb;;0BACE,0JAAC;gBAAI,OAAO;oBAAC,UAAU;oBAAI,YAAY;oBAAK,cAAc;gBAAC;;oBAAG;oBAC7C,KAAK,QAAQ;oBAAC;;;;;;;0BAE/B,0JAAC;gBAAI,OAAO;oBAAC,UAAU;oBAAI,SAAS;oBAAK,cAAc;gBAAE;;oBACtD,KAAK,IAAI,KAAK,UAAU,cAAc;oBAAO;oBAAK,KAAK,QAAQ;;;;;;;0BAElE,0JAAC;gBAAI,OAAO;oBAAC,SAAS;oBAAQ,KAAK;oBAAI,gBAAgB;oBAAU,UAAU;gBAAM;;kCAC/E,0JAAC,wHAAA,CAAA,UAAI;wBAAC,MAAK;wBAAa,OAAO;4BAAE,gBAAgB;wBAAO;kCACtD,cAAA,0JAAC;4BAAO,OAAO;gCACb,YAAY;gCACZ,OAAO;gCACP,QAAQ;gCACR,cAAc;gCACd,SAAS;gCACT,UAAU;gCACV,YAAY;gCACZ,QAAQ;gCACR,YAAY;4BACd;sCAAG;;;;;;;;;;;kCAIL,0JAAC;wBACC,SAAS;wBACT,OAAO;4BACL,YAAY;4BACZ,OAAO;4BACP,QAAQ;4BACR,cAAc;4BACd,SAAS;4BACT,UAAU;4BACV,YAAY;4BACZ,QAAQ;4BACR,YAAY;wBACd;kCACD;;;;;;;;;;;;;;;;;;AAMT;GAvDwB;;QACJ,qHAAA,CAAA,WAAQ;;;KADJ","debugId":null}},
    {"offset": {"line": 898, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Documents/GitHub/legal_analysis-nextjs/frontend/components/AuthCallToAction.tsx"],"sourcesContent":["import React from 'react';\r\nimport Link from 'next/link';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\n\r\nexport default function AuthCallToAction() {\r\n  const { theme } = useTheme();\r\n\r\n  return (\r\n    <div style={{\r\n      background: `linear-gradient(135deg, ${theme.accent} 0%, ${theme.accent2} 100%)`,\r\n      borderRadius: 16,\r\n      padding: '32px',\r\n      marginBottom: 24,\r\n      boxShadow: `0 4px 20px ${theme.accent}33`,\r\n      border: `1px solid ${theme.accent}`,\r\n      textAlign: 'center',\r\n      color: '#fff'\r\n    }}>\r\n      <div style={{fontSize: 28, fontWeight: 800, marginBottom: 16}}>\r\n        🚀 منصة التحليل القانوني الذكي\r\n      </div>\r\n      <div style={{fontSize: 18, opacity: 0.9, marginBottom: 24, lineHeight: 1.6}}>\r\n        انضم إلينا واحصل على تحليل قانوني متقدم في 12 مرحلة<br/>\r\n        مع عريضة قانونية نهائية جاهزة للمحكمة\r\n      </div>\r\n      <div style={{display: 'flex', gap: 16, justifyContent: 'center', flexWrap: 'wrap'}}>\r\n        <Link href=\"/login\" style={{ textDecoration: 'none' }}>\r\n          <button style={{\r\n            background: 'rgba(255,255,255,0.2)',\r\n            color: '#fff',\r\n            border: '2px solid rgba(255,255,255,0.3)',\r\n            borderRadius: 12,\r\n            padding: '16px 32px',\r\n            fontSize: 18,\r\n            fontWeight: 700,\r\n            cursor: 'pointer',\r\n            transition: 'all 0.3s ease',\r\n            backdropFilter: 'blur(10px)'\r\n          }}>\r\n            🔐 تسجيل الدخول\r\n          </button>\r\n        </Link>\r\n        <Link href=\"/register\" style={{ textDecoration: 'none' }}>\r\n          <button style={{\r\n            background: 'rgba(255,255,255,0.9)',\r\n            color: theme.accent,\r\n            border: '2px solid rgba(255,255,255,0.3)',\r\n            borderRadius: 12,\r\n            padding: '16px 32px',\r\n            fontSize: 18,\r\n            fontWeight: 700,\r\n            cursor: 'pointer',\r\n            transition: 'all 0.3s ease'\r\n          }}>\r\n            🚀 إنشاء حساب جديد\r\n          </button>\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":";;;;AACA;AACA;;;;;AAEe,SAAS;;IACtB,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,qHAAA,CAAA,WAAQ,AAAD;IAEzB,qBACE,0JAAC;QAAI,OAAO;YACV,YAAY,CAAC,wBAAwB,EAAE,MAAM,MAAM,CAAC,KAAK,EAAE,MAAM,OAAO,CAAC,MAAM,CAAC;YAChF,cAAc;YACd,SAAS;YACT,cAAc;YACd,WAAW,CAAC,WAAW,EAAE,MAAM,MAAM,CAAC,EAAE,CAAC;YACzC,QAAQ,CAAC,UAAU,EAAE,MAAM,MAAM,EAAE;YACnC,WAAW;YACX,OAAO;QACT;;0BACE,0JAAC;gBAAI,OAAO;oBAAC,UAAU;oBAAI,YAAY;oBAAK,cAAc;gBAAE;0BAAG;;;;;;0BAG/D,0JAAC;gBAAI,OAAO;oBAAC,UAAU;oBAAI,SAAS;oBAAK,cAAc;oBAAI,YAAY;gBAAG;;oBAAG;kCACxB,0JAAC;;;;;oBAAI;;;;;;;0BAG1D,0JAAC;gBAAI,OAAO;oBAAC,SAAS;oBAAQ,KAAK;oBAAI,gBAAgB;oBAAU,UAAU;gBAAM;;kCAC/E,0JAAC,wHAAA,CAAA,UAAI;wBAAC,MAAK;wBAAS,OAAO;4BAAE,gBAAgB;wBAAO;kCAClD,cAAA,0JAAC;4BAAO,OAAO;gCACb,YAAY;gCACZ,OAAO;gCACP,QAAQ;gCACR,cAAc;gCACd,SAAS;gCACT,UAAU;gCACV,YAAY;gCACZ,QAAQ;gCACR,YAAY;gCACZ,gBAAgB;4BAClB;sCAAG;;;;;;;;;;;kCAIL,0JAAC,wHAAA,CAAA,UAAI;wBAAC,MAAK;wBAAY,OAAO;4BAAE,gBAAgB;wBAAO;kCACrD,cAAA,0JAAC;4BAAO,OAAO;gCACb,YAAY;gCACZ,OAAO,MAAM,MAAM;gCACnB,QAAQ;gCACR,cAAc;gCACd,SAAS;gCACT,UAAU;gCACV,YAAY;gCACZ,QAAQ;gCACR,YAAY;4BACd;sCAAG;;;;;;;;;;;;;;;;;;;;;;;AAOb;GAxDwB;;QACJ,qHAAA,CAAA,WAAQ;;;KADJ","debugId":null}},
    {"offset": {"line": 1051, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/HP/Documents/GitHub/legal_analysis-nextjs/frontend/pages/index.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport Link from 'next/link';\nimport { saveApiKey, loadApiKey, addCase, getAllCases, updateCase, clearAllCases, LegalCase } from '../utils/db';\nimport { set as idbSet } from 'idb-keyval';\nimport { isMobile } from '../utils/crypto';\nimport { useTheme } from '../contexts/ThemeContext';\nimport WelcomeHeader from '../components/WelcomeHeader';\nimport AuthCallToAction from '../components/AuthCallToAction';\n\n// تعريف نوع BeforeInstallPromptEvent\ninterface BeforeInstallPromptEvent extends Event {\n  prompt(): Promise<{ outcome: 'accepted' | 'dismissed' }>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\nconst STAGES = [\n  'المرحلة الأولى: تحديد المشكلة القانونية',\n  'المرحلة الثانية: جمع المعلومات والوثائق',\n  'المرحلة الثالثة: تحليل النصوص القانونية',\n  'المرحلة الرابعة: تحديد القواعد القانونية المنطبقة',\n  'المرحلة الخامسة: تحليل السوابق القضائية',\n  'المرحلة السادسة: تحليل الفقه القانوني',\n  'المرحلة السابعة: تحليل الظروف الواقعية',\n  'المرحلة الثامنة: تحديد الحلول القانونية الممكنة',\n  'المرحلة التاسعة: تقييم الحلول القانونية',\n  'المرحلة العاشرة: اختيار الحل الأمثل',\n  'المرحلة الحادية عشرة: صياغة الحل القانوني',\n  'المرحلة الثانية عشرة: تقديم التوصيات',\n];\n\nconst FINAL_STAGE = 'المرحلة الثالثة عشرة: العريضة القانونية النهائية';\nconst ALL_STAGES = [...STAGES, FINAL_STAGE];\n\ntype PartyRole = 'المشتكي' | 'المشتكى عليه' | 'المدعي' | 'المدعى عليه';\n\nexport default function Home() {\n  const { theme, darkMode } = useTheme();\n  const [apiKey, setApiKey] = useState('');\n  const [caseNameInput, setCaseNameInput] = useState('');\n  const [showInstallPrompt, setShowInstallPrompt] = useState(false);\n  const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\n  const [activeTab, setActiveTab] = useState<'input' | 'stages' | 'results'>('input');\n  const [mounted, setMounted] = useState(false);\n  const [isSmallScreen, setIsSmallScreen] = useState(false);\n  const prevApiKey = useRef(\"\");\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [user, setUser] = useState<{username: string; role: string; officeId: string} | null>(null);\n\n  // لكل مرحلة: نص، نتيجة، تحميل، خطأ، إظهار نتيجة\n  const [mainText, setMainText] = useState('');\n  const [stageResults, setStageResults] = useState<(string|null)[]>(() => Array(ALL_STAGES.length).fill(null));\n  const [stageLoading, setStageLoading] = useState<boolean[]>(() => Array(ALL_STAGES.length).fill(false));\n  const [stageErrors, setStageErrors] = useState<(string|null)[]>(() => Array(ALL_STAGES.length).fill(null));\n  const [stageShowResult, setStageShowResult] = useState<boolean[]>(() => Array(ALL_STAGES.length).fill(false));\n  const [partyRole, setPartyRole] = useState<PartyRole | ''>('');\n\n  useEffect(() => {\n    setMounted(true);\n    \n    // التحقق من حالة تسجيل الدخول\n    const userData = localStorage.getItem('legal_user');\n    const token = localStorage.getItem('legal_token') || sessionStorage.getItem('legal_token');\n    \n    if (userData && token) {\n      try {\n        const parsedUser = JSON.parse(userData);\n        setUser(parsedUser);\n        setIsAuthenticated(true);\n      } catch (error) {\n        console.error('Error parsing user data:', error);\n        // مسح البيانات التالفة\n        localStorage.removeItem('legal_user');\n        localStorage.removeItem('legal_token');\n        sessionStorage.removeItem('legal_token');\n      }\n    }\n\n    // تحميل مفتاح API من قاعدة البيانات عند بدء التشغيل\n    loadApiKey().then(val => {\n      if (val) setApiKey(val);\n    });\n\n    // معالجة تثبيت التطبيق كتطبيق أيقونة\n    const handleBeforeInstallPrompt = (e: Event) => {\n      e.preventDefault();\n      setDeferredPrompt(e as BeforeInstallPromptEvent);\n      setShowInstallPrompt(true);\n    };\n\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n\n    // التحقق من وجود التطبيق مثبت\n    if (window.matchMedia('(display-mode: standalone)').matches) {\n      setShowInstallPrompt(false);\n    }\n\n    // مراقبة حجم الشاشة\n    const checkScreenSize = () => {\n      setIsSmallScreen(window.innerWidth <= 768);\n    };\n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  useEffect(() => {\n    // حفظ مفتاح API في قاعدة البيانات عند تغييره\n    if (apiKey) saveApiKey(apiKey);\n  }, [apiKey]);\n\n  // حفظ apiKey في Blob Storage عند تغييره\n  useEffect(() => {\n    if (apiKey && apiKey !== prevApiKey.current) {\n      prevApiKey.current = apiKey;\n    }\n  }, [apiKey]);\n\n  // دالة تثبيت التطبيق\n  const handleInstallApp = async () => {\n    if (deferredPrompt) {\n      deferredPrompt.prompt();\n      const { outcome } = await deferredPrompt.userChoice;\n      if (outcome === 'accepted') {\n        setShowInstallPrompt(false);\n        setDeferredPrompt(null);\n      }\n    }\n  };\n\n  // دالة تسجيل الخروج\n  const handleLogout = () => {\n    localStorage.removeItem('legal_user');\n    localStorage.removeItem('legal_token');\n    sessionStorage.removeItem('legal_token');\n    setIsAuthenticated(false);\n    setUser(null);\n    window.location.reload();\n  };\n\n  // دالة بدء قضية جديدة\n  const handleNewCase = () => {\n    // مسح جميع البيانات الحالية\n    setMainText('');\n    setCaseNameInput('');\n    setStageResults(Array(ALL_STAGES.length).fill(null));\n    setStageLoading(Array(ALL_STAGES.length).fill(false));\n    setStageErrors(Array(ALL_STAGES.length).fill(null));\n    setStageShowResult(Array(ALL_STAGES.length).fill(false));\n    setPartyRole('');\n    setActiveTab('input');\n  };\n\n  // دالة تحليل مرحلة واحدة\n  const handleAnalyzeStage = async (idx: number) => {\n    // إذا كانت المرحلة الأخيرة (العريضة النهائية)\n    if (idx === ALL_STAGES.length - 1) {\n      setStageLoading(arr => arr.map((v, i) => i === idx ? true : v));\n      setStageErrors(arr => arr.map((v, i) => i === idx ? null : v));\n      setStageResults(arr => arr.map((v, i) => i === idx ? null : v));\n      setStageShowResult(arr => arr.map((v, i) => i === idx ? false : v));\n      if (!apiKey) {\n        setStageErrors(arr => arr.map((v, i) => i === idx ? 'يرجى إعداد مفتاح Gemini API من صفحة الإعدادات أولاً.' : v));\n        setStageLoading(arr => arr.map((v, i) => i === idx ? false : v));\n        return;\n      }\n      const summaries = stageResults.slice(0, idx).filter(r => !!r);\n      if (summaries.length === 0) {\n        setStageErrors(arr => arr.map((v, i) => i === idx ? 'يرجى تحليل المراحل أولاً قبل توليد العريضة النهائية.' : v));\n        setStageLoading(arr => arr.map((v, i) => i === idx ? false : v));\n        return;\n      }\n      try {\n        const res = await fetch('/api/analyze', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ text: mainText, stageIndex: -1, apiKey, previousSummaries: summaries, finalPetition: true, partyRole: partyRole || undefined }),\n        });\n        const data = await res.json();\n        if (res.ok) {\n          setStageResults(arr => arr.map((v, i) => i === idx ? data.analysis : v));\n          setTimeout(() => setStageShowResult(arr => arr.map((v, i) => i === idx ? true : v)), 100);\n        } else {\n          setStageErrors(arr => arr.map((v, i) => i === idx ? (data.error || 'حدث خطأ أثناء توليد العريضة النهائية') : v));\n        }\n      } catch {\n        setStageErrors(arr => arr.map((v, i) => i === idx ? 'تعذر الاتصال بالخادم' : v));\n      } finally {\n        setStageLoading(arr => arr.map((v, i) => i === idx ? false : v));\n      }\n      return;\n    }\n    setStageLoading(arr => arr.map((v, i) => i === idx ? true : v));\n    setStageErrors(arr => arr.map((v, i) => i === idx ? null : v));\n    setStageResults(arr => arr.map((v, i) => i === idx ? null : v));\n    setStageShowResult(arr => arr.map((v, i) => i === idx ? false : v));\n    if (!apiKey) {\n      setStageErrors(arr => arr.map((v, i) => i === idx ? 'يرجى إعداد مفتاح Gemini API من صفحة الإعدادات أولاً.' : v));\n      setStageLoading(arr => arr.map((v, i) => i === idx ? false : v));\n      return;\n    }\n    const text = mainText;\n    if (!text.trim()) {\n      setStageErrors(arr => arr.map((v, i) => i === idx ? 'يرجى إدخال تفاصيل القضية.' : v));\n      setStageLoading(arr => arr.map((v, i) => i === idx ? false : v));\n      return;\n    }\n    // جمع ملخصات المراحل السابقة (النتائج غير الفارغة فقط)\n    let previousSummaries = stageResults.slice(0, idx).filter(r => !!r);\n    // حدود الطول (تقريبي: 8000 tokens ≈ 24,000 حرف)\n    const MAX_CHARS = 24000;\n    let totalLength = previousSummaries.reduce((acc, cur) => acc + (cur?.length || 0), 0);\n    // إذا تجاوز الطول، احذف أقدم النتائج حتى لا يتجاوز الحد\n    while (totalLength > MAX_CHARS && previousSummaries.length > 1) {\n      previousSummaries = previousSummaries.slice(1);\n      totalLength = previousSummaries.reduce((acc, cur) => acc + (cur?.length || 0), 0);\n    }\n    try {\n      const res = await fetch('/api/analyze', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ text, stageIndex: idx, apiKey, previousSummaries, partyRole: partyRole || undefined }),\n      });\n      const data = await res.json();\n      if (res.ok) {\n        setStageResults(arr => arr.map((v, i) => i === idx ? data.analysis : v));\n        setTimeout(() => setStageShowResult(arr => arr.map((v, i) => i === idx ? true : v)), 100);\n        // حفظ التحليل ضمن نفس القضية إن وُجدت، وإلا إنشاؤها\n        const caseName = caseNameInput.trim() ? caseNameInput.trim() : `قضية بدون اسم - ${Date.now()}`;\n        const newStage = {\n          id: `${idx}-${btoa(unescape(encodeURIComponent(text))).slice(0,8)}-${Date.now()}`,\n          stageIndex: idx,\n          stage: ALL_STAGES[idx],\n          input: text,\n          output: data.analysis,\n          date: new Date().toISOString(),\n        };\n        const allCases: LegalCase[] = await getAllCases();\n        const existing = allCases.find((c: LegalCase) => c.name === caseName);\n        if (existing) {\n          existing.stages.push(newStage);\n          await updateCase(existing);\n        } else {\n        const newCaseId = `${caseName}-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;\n        await addCase({\n          id: newCaseId,\n          name: caseName,\n          createdAt: newStage.date,\n          stages: [newStage],\n        });\n        }\n      } else {\n        if (data.error && data.error.includes('429')) {\n          setStageErrors(arr => arr.map((v, i) => i === idx ? 'لقد تجاوزت الحد المسموح به لعدد الطلبات على خدمة Gemini API. يرجى الانتظار دقيقة ثم إعادة المحاولة. إذا تكررت المشكلة، استخدم مفتاح API آخر أو راجع إعدادات حسابك في Google AI Studio.' : v));\n        } else {\n          setStageErrors(arr => arr.map((v, i) => i === idx ? (data.error || 'حدث خطأ أثناء التحليل') : v));\n        }\n      }\n    } catch {\n      setStageErrors(arr => arr.map((v, i) => i === idx ? 'تعذر الاتصال بالخادم' : v));\n    } finally {\n      setStageLoading(arr => arr.map((v, i) => i === idx ? false : v));\n    }\n  };\n\n  if (!mounted) {\n    return null; // تجنب hydration mismatch\n  }\n\n  return (\n    <>\n      <div style={{\n        fontFamily: 'Tajawal, Arial, sans-serif',\n        direction: 'rtl',\n        minHeight: '100vh',\n        background: theme.background,\n        color: theme.text,\n        padding: 0,\n        margin: 0,\n        transition: 'background 0.4s',\n      }}>\n        <main style={{\n          maxWidth: 800,\n          width: '100%',\n          margin: '0 auto',\n          padding: isMobile() ? '1rem 0.5rem' : '2rem 1rem',\n        }}>\n          {/* شريط الترحيب للمستخدمين المسجلين */}\n          {isAuthenticated && user && (\n            <WelcomeHeader user={user} onLogout={handleLogout} />\n          )}\n\n          {/* تنبيه إعداد المفتاح عند الحاجة */}\n          {!apiKey && isAuthenticated && (\n            <div style={{\n              background: '#fffbe6',\n              color: '#b7791f',\n              border: '1px solid #f6ad55',\n              borderRadius: 12,\n              padding: '12px 16px',\n              marginBottom: 16,\n              boxShadow: '0 1px 6px #b7791f22',\n              fontWeight: 700,\n              textAlign: 'center'\n            }}>\n              لم يتم إعداد مفتاح Gemini API بعد. انتقل إلى <Link href=\"/settings\" style={{color: theme.accent, textDecoration:'underline'}}>الإعدادات</Link> لإعداده.\n            </div>\n          )}\n\n          {/* شريط إجراءات الصفحة - للمستخدمين المسجلين فقط */}\n          {isAuthenticated ? (\n            <div style={{display:'flex', gap:12, flexWrap:'wrap', justifyContent:'center', marginBottom:16}}>\n              <button\n                onClick={handleNewCase}\n                style={{\n                  background: 'rgba(99, 102, 241, 0.1)', color: theme.accent2, border: `1px solid ${theme.accent2}`, borderRadius: 8,\n                  padding: isSmallScreen ? '8px 16px' : '6px 14px', fontWeight: 700, fontSize: isSmallScreen ? 14 : 16,\n                  cursor: 'pointer', boxShadow: `0 1px 4px ${theme.shadow}`, letterSpacing: 1, transition: 'all 0.2s',\n                  width: 'auto',\n                }}\n              >\n                🆕 قضية جديدة\n              </button>\n              {showInstallPrompt && (\n                <button\n                  onClick={handleInstallApp}\n                  style={{\n                    background: 'rgba(16, 185, 129, 0.1)', color: '#0f766e', border: '1px solid #99f6e4', borderRadius: 8,\n                    padding: isSmallScreen ? '8px 16px' : '6px 14px', fontWeight: 700, fontSize: isSmallScreen ? 14 : 16,\n                    cursor: 'pointer', boxShadow: '0 1px 4px #0002', letterSpacing: 1, transition: 'all 0.2s',\n                    width: 'auto'\n                  }}\n                >\n                  📱 تثبيت التطبيق\n                </button>\n              )}\n            </div>\n          ) : (\n            /* دعوة للعمل للمستخدمين غير المسجلين */\n            <AuthCallToAction />\n          )}\n\n          {/* نظام التبويبات - للمستخدمين المسجلين فقط */}\n          {isAuthenticated ? (\n            <>\n              <div style={{\n                background: theme.card,\n                borderRadius: 16,\n                boxShadow: `0 4px 20px ${theme.shadow}`,\n                marginBottom: 24,\n                border: `1.5px solid ${theme.border}`,\n                overflow: 'hidden',\n              }}>\n                <div style={{\n                  display: 'flex',\n                  background: darkMode ? '#2a2d3e' : '#f8fafc',\n                  borderBottom: `1px solid ${theme.border}`,\n                }}>\n                  {[\n                    { id: 'input', label: '📝 إدخال البيانات', icon: '✍️' },\n                    { id: 'stages', label: '🔍 مراحل التحليل', icon: '⚖️' },\n                    { id: 'results', label: '📊 النتائج', icon: '📈' }\n                  ].map((tab) => (\n                    <button\n                      key={tab.id}\n                      onClick={() => setActiveTab(tab.id as 'input' | 'stages' | 'results')}\n                      style={{\n                        flex: 1,\n                        padding: isMobile() ? '12px 8px' : '16px 12px',\n                        background: activeTab === tab.id ? theme.accent : 'transparent',\n                        color: activeTab === tab.id ? '#fff' : theme.text,\n                        border: 'none',\n                        cursor: 'pointer',\n                        fontSize: isMobile() ? 14 : 16,\n                        fontWeight: 600,\n                        transition: 'all 0.3s ease',\n                        display: 'flex',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        gap: 8,\n                      }}\n                    >\n                      <span>{tab.icon}</span>\n                      <span style={{ display: isMobile() ? 'none' : 'inline' }}>{tab.label}</span>\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* محتوى التبويبات */}\n              {activeTab === 'input' && (\n                <>\n                  {/* مربع نص واحد لتفاصيل القضية */}\n                  <div style={{\n                    background: theme.card,\n                    borderRadius: 14,\n                    boxShadow: `0 2px 12px ${theme.shadow}`,\n                    padding: isMobile() ? 16 : 24,\n                    marginBottom: 24,\n                    border: `1.5px solid ${theme.border}`,\n                  }}>\n                    {/* مربع إدخال اسم القضية في رأس مربع التفاصيل */}\n                    <div style={{ marginBottom: 16 }}>\n                      <div style={{display:'flex', alignItems:'center', gap:8, marginBottom:12}}>\n                        <span style={{fontSize:20}}>📛</span>\n                        <label style={{ fontWeight: 700, color: theme.accent2, fontSize: 16 }}>اسم القضية:</label>\n                      </div>\n                      <input\n                        type=\"text\"\n                        value={caseNameInput}\n                        onChange={e => setCaseNameInput(e.target.value)}\n                        placeholder=\"أدخل اسم القضية (مثال: قضية إيجار 2024)\"\n                        style={{ \n                          width: '100%', \n                          borderRadius: 12, \n                          border: `2px solid ${theme.input}`, \n                          padding: isMobile() ? 12 : 16, \n                          fontSize: isMobile() ? 16 : 18, \n                          marginBottom: 0, \n                          outline: 'none', \n                          boxShadow: `0 2px 8px ${theme.shadow}`, \n                          background: darkMode ? '#181a2a' : '#fff', \n                          color: theme.text, \n                          transition: 'all 0.3s ease',\n                          fontFamily: 'Tajawal, Arial, sans-serif'\n                        }}\n                        required\n                      />\n                    </div>\n                    \n                    <div style={{display:'flex', alignItems:'center', gap:8, marginBottom:12}}>\n                      <span style={{fontSize:20}}>👥</span>\n                      <label style={{ fontWeight: 700, color: theme.accent, fontSize: 16 }}>صفة المستخدم في الدعوى:</label>\n                    </div>\n                    \n                    <div style={{\n                      background: theme.resultBg,\n                      borderRadius: 12,\n                      padding: 16,\n                      marginBottom: 16,\n                      border: `1px solid ${theme.input}`,\n                      fontSize: 14,\n                      lineHeight: 1.6,\n                      color: theme.text\n                    }}>\n                      <div style={{fontWeight: 700, color: theme.accent2, marginBottom: 8}}>📋 ملاحظة:</div>\n                      <div style={{marginBottom: 8}}><strong>المشتكي:</strong> <span style={{color: '#dc2626', fontWeight: 600}}>جزائية (جنائية)</span> - صاحب الشكوى ضد شخص ارتكب جريمة</div>\n                      <div style={{marginBottom: 8}}><strong>المشتكى عليه:</strong> <span style={{color: '#dc2626', fontWeight: 600}}>جزائية (جنائية)</span> - الشخص المتهم بارتكاب الجريمة في مرحلة التحقيق</div>\n                      <div style={{marginBottom: 8}}><strong>المدعي:</strong> <span style={{color: '#059669', fontWeight: 600}}>مدنية</span> - من يرفع دعوى للمطالبة بحق مادي أو معنوي</div>\n                      <div style={{marginBottom: 8}}><strong>المدعى عليه:</strong> <span style={{color: '#059669', fontWeight: 600}}>مدنية</span> - الطرف المخاصم الذي تُرفع عليه الدعوى</div>\n                      <div style={{fontSize: 13, opacity: 0.8, fontStyle: 'italic', marginTop: 12, paddingTop: 12, borderTop: `1px solid ${theme.border}`}}>اختر صفتك ليتخصص التحليل والعريضة وفق مصلحتك في الدعوى</div>\n                    </div>\n                    \n                    <div style={{ display:'flex', gap:8, flexWrap:'wrap', marginBottom: 16 }}>\n                      {(['المشتكي','المشتكى عليه','المدعي','المدعى عليه'] as PartyRole[]).map(role => (\n                        <button key={role}\n                          onClick={() => setPartyRole(role === partyRole ? '' : role)}\n                          style={{\n                            background: role === partyRole ? theme.accent : 'transparent',\n                            color: role === partyRole ? '#fff' : theme.text,\n                            border: `2px solid ${theme.input}`,\n                            borderRadius: 10,\n                            padding: '8px 12px',\n                            cursor: 'pointer',\n                            fontWeight: 700\n                          }}\n                        >{role}</button>\n                      ))}\n                    </div>\n                    \n                    <div style={{display:'flex', alignItems:'center', gap:8, marginBottom:12}}>\n                      <span style={{fontSize:20}}>📄</span>\n                      <label style={{ fontWeight: 700, color: theme.accent, fontSize: 16 }}>تفاصيل القضية:</label>\n                    </div>\n                    \n                    <textarea\n                      value={mainText}\n                      onChange={e => setMainText(e.target.value)}\n                      rows={6}\n                      style={{ \n                        width: '100%', \n                        borderRadius: 12, \n                        border: `2px solid ${theme.input}`, \n                        padding: isMobile() ? 12 : 16, \n                        fontSize: isMobile() ? 16 : 18, \n                        marginBottom: 0, \n                        resize: 'vertical', \n                        outline: 'none', \n                        boxShadow: `0 2px 8px ${theme.shadow}`, \n                        background: darkMode ? '#181a2a' : '#fff', \n                        color: theme.text, \n                        transition: 'all 0.3s ease',\n                        fontFamily: 'Tajawal, Arial, sans-serif',\n                        lineHeight: 1.6\n                      }}\n                      placeholder=\"أدخل تفاصيل القضية هنا...\"\n                      required\n                    />\n                  </div>\n\n                  {/* زر البدء السريع */}\n                  <div style={{\n                    background: `linear-gradient(135deg, ${theme.accent2} 0%, ${theme.accent} 100%)`,\n                    borderRadius: 16,\n                    padding: isMobile() ? 20 : 28,\n                    textAlign: 'center',\n                    boxShadow: `0 4px 20px ${theme.accent}33`,\n                    border: `1px solid ${theme.accent}`,\n                  }}>\n                    <div style={{fontSize: isMobile() ? 20 : 24, fontWeight: 800, color: '#fff', marginBottom: 12}}>\n                      🚀 جاهز للبدء؟\n                    </div>\n                    <div style={{fontSize: isMobile() ? 14 : 16, color: 'rgba(255,255,255,0.9)', marginBottom: 20, lineHeight: 1.6}}>\n                      بعد إدخال البيانات، انتقل إلى تبويب &quot;مراحل التحليل&quot; لبدء العملية\n                    </div>\n                    <button\n                      onClick={() => setActiveTab('stages')}\n                      style={{\n                        background: 'rgba(255,255,255,0.2)', \n                        color: '#fff', \n                        border: '2px solid rgba(255,255,255,0.3)', \n                        borderRadius: 12, \n                        padding: isMobile() ? '12px 24px' : '16px 32px', \n                        fontSize: isMobile() ? 16 : 18, \n                        fontWeight: 700, \n                        cursor: 'pointer', \n                        transition: 'all 0.3s ease',\n                        backdropFilter: 'blur(10px)',\n                      }}\n                    >\n                      ⚖️ الانتقال لمراحل التحليل\n                    </button>\n                  </div>\n                </>\n              )}\n\n              {/* محتوى التبويب الثاني: مراحل التحليل */}\n              {activeTab === 'stages' && (\n                <>\n                  {/* عرض جميع المراحل */}\n                  {ALL_STAGES.map((stage, idx) => (\n                    <div key={stage} style={{\n                      background: theme.card,\n                      borderRadius: 16,\n                      boxShadow: `0 4px 20px ${theme.shadow}`,\n                      padding: isMobile() ? 16 : 24,\n                      marginBottom: 24,\n                      border: `1.5px solid ${theme.border}`,\n                      transition: 'all 0.3s ease',\n                    }}>\n                      <div style={{ \n                        fontWeight: 800, \n                        color: theme.accent, \n                        fontSize: isMobile() ? 16 : 18, \n                        marginBottom: 16,\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: 8,\n                      }}>\n                        <span style={{fontSize: isMobile() ? 20 : 24}}>⚖️</span>\n                        {stage}\n                      </div>\n                      \n                      {/* ملخص التحليل السابق */}\n                      {idx > 0 && stageResults[idx-1] && (\n                        <div style={{\n                          background: theme.resultBg,\n                          borderRadius: 12,\n                          boxShadow: `0 2px 8px ${theme.shadow}`,\n                          padding: 16,\n                          marginBottom: 16,\n                          border: `1px solid ${theme.input}`,\n                          color: theme.text,\n                          fontSize: 15,\n                          opacity: 0.95,\n                        }}>\n                          <div style={{fontWeight: 700, color: theme.accent2, marginBottom: 8}}>📋 ملخص المرحلة السابقة:</div>\n                          <div style={{ whiteSpace: 'pre-line', marginTop: 4, lineHeight: 1.6 }}>{stageResults[idx-1]}</div>\n                        </div>\n                      )}\n                      \n                      {/* إذا كانت المرحلة الأخيرة، غير نص الزر */}\n                      <button\n                        type=\"button\"\n                        disabled={stageLoading[idx]}\n                        onClick={() => handleAnalyzeStage(idx)}\n                        style={{ \n                          width: '100%', \n                          background: `linear-gradient(135deg, ${theme.accent2} 0%, ${theme.accent} 100%)`, \n                          color: '#fff', \n                          border: 'none', \n                          borderRadius: 12, \n                          padding: isMobile() ? '14px 0' : '18px 0', \n                          fontSize: isMobile() ? 16 : 18, \n                          fontWeight: 800, \n                          cursor: stageLoading[idx] ? 'not-allowed' : 'pointer', \n                          marginTop: 8, \n                          boxShadow: `0 4px 16px ${theme.accent}33`, \n                          letterSpacing: 1, \n                          transition: 'all 0.3s ease', \n                          position:'relative',\n                          transform: stageLoading[idx] ? 'scale(0.98)' : 'scale(1)',\n                        }}\n                      >\n                        {stageLoading[idx] ? (\n                          <span style={{display:'inline-flex', alignItems:'center', gap:8}}>\n                            <span className=\"spinner\" style={{display:'inline-block', width:20, height:20, border:'3px solid #fff', borderTop:`3px solid ${theme.accent2}`, borderRadius:'50%', animation:'spin 1s linear infinite', verticalAlign:'middle'}}></span>\n                            {idx === ALL_STAGES.length - 1 ? '⏳ جاري توليد العريضة النهائية...' : '⏳ جاري التحليل...'}\n                          </span>\n                        ) : (\n                          idx === ALL_STAGES.length - 1 ? '📜 توليد العريضة القانونية النهائية' : `📜 تحليل ${stage}`\n                        )}\n                      </button>\n                      \n                      {stageErrors[idx] && (\n                        <div style={{ \n                          color: theme.errorText, \n                          background: theme.errorBg, \n                          borderRadius: 12, \n                          padding: 16, \n                          marginTop: 16, \n                          textAlign: 'center', \n                          fontWeight: 700, \n                          fontSize: 15, \n                          boxShadow: `0 2px 8px ${theme.errorText}22`,\n                          border: `1px solid ${theme.errorText}33`\n                        }}>\n                          ❌ {stageErrors[idx]}\n                        </div>\n                      )}\n                      \n                      {stageResults[idx] && (\n                        <div style={{\n                          background: theme.resultBg,\n                          borderRadius: 16,\n                          boxShadow: `0 4px 20px ${theme.shadow}`,\n                          padding: 20,\n                          marginTop: 20,\n                          border: `1.5px solid ${theme.input}`,\n                          color: theme.text,\n                          opacity: stageShowResult[idx] ? 1 : 0,\n                          transform: stageShowResult[idx] ? 'translateY(0)' : 'translateY(30px)',\n                          transition: 'all 0.7s ease',\n                        }}>\n                          <h3 style={{ color: theme.accent, marginBottom: 12, fontSize: 18, fontWeight: 800, letterSpacing: 1, display: 'flex', alignItems: 'center', gap: 8 }}>\n                            <span>🔍</span>\n                            نتيجة التحليل\n                          </h3>\n                          <div style={{ whiteSpace: 'pre-line', fontSize: 16, lineHeight: 1.8 }}>{stageResults[idx]}</div>\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </>\n              )}\n\n              {/* محتوى التبويب الثالث: النتائج */}\n              {activeTab === 'results' && (\n                <div style={{\n                  background: theme.card,\n                  borderRadius: 16,\n                  boxShadow: `0 4px 20px ${theme.shadow}`,\n                  padding: isMobile() ? 20 : 32,\n                  border: `1.5px solid ${theme.border}`,\n                }}>\n                  <div style={{fontSize: isMobile() ? 24 : 32, fontWeight: 900, color: theme.accent, marginBottom: 16}}>\n                    📊 ملخص النتائج\n                  </div>\n                  \n                  {/* عرض إحصائيات سريعة */}\n                  <div style={{\n                    display: 'grid',\n                    gridTemplateColumns: isMobile() ? '1fr' : 'repeat(3, 1fr)',\n                    gap: 16,\n                    marginBottom: 24,\n                  }}>\n                    <div style={{\n                      background: theme.resultBg,\n                      borderRadius: 12,\n                      padding: 16,\n                      border: `1px solid ${theme.border}`,\n                      textAlign: 'center',\n                    }}>\n                      <div style={{fontSize: 24, fontWeight: 800, color: theme.accent}}>\n                        {stageResults.filter(r => !!r).length}\n                      </div>\n                      <div style={{fontSize: 14, color: theme.text}}>مرحلة مكتملة</div>\n                    </div>\n                    <div style={{\n                      background: theme.resultBg,\n                      borderRadius: 12,\n                      padding: 16,\n                      border: `1px solid ${theme.border}`,\n                      textAlign: 'center',\n                    }}>\n                      <div style={{fontSize: 24, fontWeight: 800, color: theme.accent2}}>\n                        {ALL_STAGES.length - stageResults.filter(r => !!r).length}\n                      </div>\n                      <div style={{fontSize: 14, color: theme.text}}>مرحلة متبقية</div>\n                    </div>\n                    <div style={{\n                      background: theme.resultBg,\n                      borderRadius: 12,\n                      padding: 16,\n                      border: `1px solid ${theme.border}`,\n                      textAlign: 'center',\n                    }}>\n                      <div style={{fontSize: 24, fontWeight: 800, color: theme.accent}}>\n                        {Math.round((stageResults.filter(r => !!r).length / ALL_STAGES.length) * 100)}%\n                      </div>\n                      <div style={{fontSize: 14, color: theme.text}}>نسبة الإنجاز</div>\n                    </div>\n                  </div>\n\n                  {/* عرض النتائج الفعلية */}\n                  {stageResults.some(r => !!r) ? (\n                    <>\n                      <div style={{fontSize: isMobile() ? 16 : 18, color: theme.text, marginBottom: 24, lineHeight: 1.6, textAlign: 'center'}}>\n                        نتائج المراحل المكتملة\n                      </div>\n                      <div style={{\n                        display: 'grid',\n                        gridTemplateColumns: isMobile() ? '1fr' : 'repeat(2, 1fr)',\n                        gap: 16,\n                      }}>\n                        {stageResults.map((result, idx) => result && (\n                          <div key={idx} style={{\n                            background: theme.resultBg,\n                            borderRadius: 12,\n                            padding: 16,\n                            border: `1px solid ${theme.border}`,\n                            cursor: 'pointer',\n                            transition: 'all 0.3s ease',\n                          }}\n                          onClick={() => setActiveTab('stages')}\n                          title=\"انقر للانتقال إلى مراحل التحليل\"\n                          >\n                            <div style={{fontWeight: 700, color: theme.accent2, marginBottom: 8, fontSize: 14}}>\n                              {ALL_STAGES[idx]}\n                            </div>\n                            <div style={{fontSize: 13, color: theme.text, lineHeight: 1.5}}>\n                              {result.substring(0, 120)}...\n                            </div>\n                            <div style={{\n                              fontSize: 11,\n                              color: theme.accent,\n                              marginTop: 8,\n                              textAlign: 'center',\n                              fontWeight: 600\n                            }}>\n                              انقر لعرض النتيجة كاملة\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </>\n                  ) : (\n                    <div style={{\n                      background: theme.resultBg,\n                      borderRadius: 12,\n                      padding: 32,\n                      border: `1px solid ${theme.border}`,\n                      textAlign: 'center',\n                      color: theme.text,\n                    }}>\n                      <div style={{fontSize: 48, marginBottom: 16}}>📝</div>\n                      <div style={{fontSize: 18, fontWeight: 700, marginBottom: 12}}>لا توجد نتائج بعد</div>\n                      <div style={{fontSize: 14, opacity: 0.8, marginBottom: 20}}>\n                        ابدأ بتحليل المراحل في تبويب &quot;مراحل التحليل&quot; لرؤية النتائج هنا\n                      </div>\n                      <button\n                        onClick={() => setActiveTab('stages')}\n                        style={{\n                          background: theme.accent,\n                          color: '#fff',\n                          border: 'none',\n                          borderRadius: 8,\n                          padding: '12px 24px',\n                          fontSize: 16,\n                          fontWeight: 700,\n                          cursor: 'pointer',\n                        }}\n                      >\n                        الانتقال لمراحل التحليل\n                      </button>\n                    </div>\n                  )}\n                </div>\n              )}\n            </>\n          ) : (\n            null\n          )}\n        </main>\n        \n        {/* Footer محسن */}\n        <footer style={{ \n          textAlign: 'center', \n          color: '#888', \n          marginTop: 48, \n          fontSize: 15,\n          background: theme.card,\n          borderRadius: 16,\n          padding: isMobile() ? 20 : 32,\n          boxShadow: `0 4px 20px ${theme.shadow}`,\n          border: `1px solid ${theme.border}`,\n          margin: '48px auto 0',\n          maxWidth: 800,\n          width: '90%',\n        }}>\n          <div style={{fontSize: 18, fontWeight: 700, color: theme.accent, marginBottom: 16}}>\n            &copy; {new Date().getFullYear()} منصة التحليل القانوني الذكي\n          </div>\n          <div style={{\n            marginTop: 18, \n            background: darkMode ? '#2a1a1a' : '#fffbe6', \n            color: darkMode ? '#ffb6b6' : '#b7791f', \n            borderRadius: 12, \n            padding: '16px 20px', \n            display: 'inline-block', \n            fontWeight: 700, \n            fontSize: 14, \n            boxShadow: `0 2px 8px ${darkMode ? '#ff6b6b22' : '#b7791f22'}`,\n            border: `1px solid ${darkMode ? '#ff6b6b33' : '#b7791f33'}`,\n            maxWidth: '90%',\n            lineHeight: 1.6\n          }}>\n            ⚠️ جميع بياناتك (القضايا والمفاتيح) تحفظ محليًا على جهازك فقط ولا يتم رفعها إلى أي خادم.\n            <button \n              onClick={async () => { \n                await clearAllCases(); \n                await idbSet('legal_dark_mode', '0'); \n                window.location.reload(); \n              }} \n              style={{\n                marginRight: 12, \n                background: '#ff6b6b', \n                color: '#fff', \n                border: 'none', \n                borderRadius: 8, \n                padding: '8px 18px', \n                fontWeight: 800, \n                fontSize: 14, \n                cursor: 'pointer', \n                boxShadow: '0 2px 8px #ff6b6b22', \n                marginLeft: 8,\n                transition: 'all 0.3s ease'\n              }}\n            >\n              🗑️ مسح كل البيانات\n            </button>\n          </div>\n        </footer>\n      </div>\n      <style>{`\n        @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }\n      `}</style>\n    </>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2696, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/entry/page-loader.ts"],"sourcesContent":["const PAGE_PATH = \"/\";\n\n/// <reference types=\"next/client\" />\r\n\r\n// inserted by rust code\r\ndeclare const PAGE_PATH: string\r\n\r\n  // Adapted from https://github.com/vercel/next.js/blob/b7f9f1f98fc8ab602e84825105b5727272b72e7d/packages/next/src/build/webpack/loaders/next-client-pages-loader.ts\r\n;(window.__NEXT_P = window.__NEXT_P || []).push([\r\n  PAGE_PATH,\r\n  () => {\r\n    return require('PAGE')\r\n  },\r\n])\r\n// @ts-expect-error module.hot exists\r\nif (module.hot) {\r\n  // @ts-expect-error module.hot exists\r\n  module.hot.dispose(function () {\r\n    window.__NEXT_P.push([PAGE_PATH])\r\n  })\r\n}\r\n"],"names":[],"mappings":"AAAA,MAAM,YAAY;AAQjB,CAAC,OAAO,QAAQ,GAAG,OAAO,QAAQ,IAAI,EAAE,EAAE,IAAI,CAAC;IAC9C;IACA;QACE;IACF;CACD;AACD,qCAAqC;AACrC,IAAI,OAAO,GAAG,EAAE;IACd,qCAAqC;IACrC,OAAO,GAAG,CAAC,OAAO,CAAC;QACjB,OAAO,QAAQ,CAAC,IAAI,CAAC;YAAC;SAAU;IAClC;AACF","ignoreList":[0],"debugId":null}}]
}