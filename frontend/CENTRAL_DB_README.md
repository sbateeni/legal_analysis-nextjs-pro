# ๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑูุฒูุฉ - ููุตุฉ ุงูุชุญููู ุงููุงูููู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุงุนุฏุฉ ุจูุงูุงุช ูุฑูุฒู ุฌุฏูุฏ ูุญู ูุดููุฉ ุนุฏู ุงููุฒุงููุฉ ุจูู ุงูุฃุฌูุฒุฉ. ุงูุขู ุฌููุน ุงููุณุชุฎุฏููู ูุณุชุฎุฏููู ูุงุนุฏุฉ ุจูุงูุงุช ูุงุญุฏุฉ ูุฑูุฒูุฉ ูุน ุถูุงู ุงูุฎุตูุตูุฉ ุงูุชุงูุฉ.

## ๐๏ธ ุงูุจููุฉ ุงูุฌุฏูุฏุฉ

### 1. **ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑูุฒูุฉ** (`central-db.ts`)
- ูุงุนุฏุฉ ุจูุงูุงุช SQLite ูุฑูุฒูุฉ ูุงุญุฏุฉ
- ุฌููุน ุงููุณุชุฎุฏููู ูุดุงุฑููู ููุณ ุงููุงุนุฏุฉ
- ุฎุตูุตูุฉ ูุถูููุฉ ุนุจุฑ `userId` ููู ุนูููุฉ

### 2. **API ุงููุฑูุฒู** (`/api/database.ts`)
- ููุทุฉ ูุตูู ูุงุญุฏุฉ ูุฌููุน ุงูุนูููุงุช
- ูุนุงูุฌุฉ ุขููุฉ ููุจูุงูุงุช
- ุฏุนู ูุงูู ููุนูููุงุช CRUD

### 3. **ูุธุงู ุงููุตุงุฏูุฉ ุงููุฑูุฒู** (`auth.embedded.central.ts`)
- ูุตุงุฏูุฉ ููุญุฏุฉ ูุฌููุน ุงููุณุชุฎุฏููู
- ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ูุงูุงุดุชุฑุงูุงุช
- ูุตูู ุขูู ููุจูุงูุงุช

## ๐ ูุจุฏุฃ ุงูุฎุตูุตูุฉ

```
ุงููุณุชุฎุฏู A (userId: abc123) โโ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑูุฒูุฉ โโ ุงููุณุชุฎุฏู B (userId: def456)
     โ                                                           โ
  ูุฑู ููุท ุจูุงูุงุชู (WHERE userId = 'abc123')              ูุฑู ููุท ุจูุงูุงุชู (WHERE userId = 'def456')
```

**ูุซุงู:**
- ุงููุณุชุฎุฏู A ููุดุฆ ูุถูุฉ โ ุชูุญูุธ ูุน `userId: 'abc123'`
- ุงููุณุชุฎุฏู B ููุดุฆ ูุถูุฉ โ ุชูุญูุธ ูุน `userId: 'def456'`
- ูู ูุณุชุฎุฏู ูุฑู ููุท ูุถุงูุงู ุงูุฎุงุตุฉ

## ๐ ุงููููุฒุงุช

### โ **ุงููุฒุงููุฉ ุงูููุฑูุฉ**
- ุงูุจูุงูุงุช ุชูุญุฏุซ ููุฑุงู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
- ูุง ุญุงุฌุฉ ูุชุตุฏูุฑ/ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุญุฏุฉ

### โ **ุงูุฎุตูุตูุฉ ุงููุถูููุฉ**
- ูู ูุณุชุฎุฏู ูุนุฒูู ุชูุงูุงู
- ูุง ูููู ูุฃู ูุณุชุฎุฏู ุงููุตูู ูุจูุงูุงุช ุงูุขุฎุฑูู
- ููุงุฑุณ ูุญุณูุฉ ููุฃุฏุงุก ูุงูุฃูุงู

### โ **ุงูุฃูุงู ุงููุชูุฏู**
- ุชุดููุฑ ูููุงุช ุงููุฑูุฑ ุจู bcrypt
- ุชุญูู ูู ุตุญุฉ ุงูุฌูุณุงุช
- ุญูุงูุฉ ูู SQL Injection

### โ **ุณูููุฉ ุงูุตูุงูุฉ**
- ูุงุนุฏุฉ ุจูุงูุงุช ูุงุญุฏุฉ ููุตูุงูุฉ
- ูุณุฎ ุงุญุชูุงุทูุฉ ูุฑูุฒูุฉ
- ุชุญุฏูุซุงุช ููุญุฏุฉ

## ๐ ุงููููุงุช ุงูุฌุฏูุฏุฉ

```
frontend/
โโโ utils/
โ   โโโ central-db.ts              # ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑูุฒูุฉ
โ   โโโ auth.embedded.central.ts   # ูุธุงู ุงููุตุงุฏูุฉ ุงููุฑูุฒู
โโโ pages/
โ   โโโ api/
โ   โ   โโโ database.ts            # API ูููุตูู ููุจูุงูุงุช
โ   โโโ test-central-db.tsx        # ุตูุญุฉ ุงุฎุชุจุงุฑ ุงููุธุงู
โโโ CENTRAL_DB_README.md           # ูุฐุง ุงูููู
```

## ๐ง ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### 1. **ุชุซุจูุช ุงูุชุจุนูุงุช**
```bash
npm install sqlite3 sqlite
```

### 2. **ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช**
```typescript
import { centralDB } from './utils/central-db';

// ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑูุฒูุฉ
await centralDB.init();
```

### 3. **ุงุณุชุฎุฏุงู ูุธุงู ุงููุตุงุฏูุฉ**
```typescript
import { centralEmbeddedAuth } from './utils/auth.embedded.central';

// ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ
const userId = await centralEmbeddedAuth.registerUser(
  'user@example.com',
  'password123',
  'ุงุณู ุงููุณุชุฎุฏู'
);

// ุชุณุฌูู ุงูุฏุฎูู
const user = await centralEmbeddedAuth.loginUser(
  'user@example.com',
  'password123'
);
```

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

### **ุตูุญุฉ ุงูุงุฎุชุจุงุฑ: `/test-central-db`**

1. **ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช** - ุงุฎุชุจุงุฑ ุดุงูู ูููุธุงู
2. **ุงุฎุชุจุงุฑ ุงูุฎุตูุตูุฉ** - ุงูุชุฃูุฏ ูู ุนุฒู ุงูุจูุงูุงุช
3. **ุชูุธูู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ** - ุญุฐู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ

### **ุงุฎุชุจุงุฑุงุช ุชููุงุฆูุฉ:**
- โ ุฅูุดุงุก ุงููุณุชุฎุฏููู
- โ ุชุณุฌูู ุงูุฏุฎูู
- โ ุฅูุดุงุก ุงููุถุงูุง
- โ ุฌูุจ ุงูุจูุงูุงุช
- โ ุญูุธ ุงูุชูุถููุงุช
- โ ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช
- โ ุงูุชุญูู ูู ุงูุฎุตูุตูุฉ

## ๐ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### **ุฌุฏูู ุงููุณุชุฎุฏููู**
```sql
CREATE TABLE users (
  id TEXT PRIMARY KEY,
  email TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL,
  fullName TEXT NOT NULL,
  createdAt TEXT NOT NULL,
  subscriptionType TEXT DEFAULT 'free',
  lastLogin TEXT,
  isActive BOOLEAN DEFAULT 1
);
```

### **ุฌุฏูู ุงููุถุงูุง**
```sql
CREATE TABLE cases (
  id TEXT PRIMARY KEY,
  userId TEXT NOT NULL,
  name TEXT NOT NULL,
  caseType TEXT,
  partyRole TEXT,
  complexity TEXT,
  status TEXT DEFAULT 'active',
  tags TEXT,
  description TEXT,
  createdAt TEXT NOT NULL,
  updatedAt TEXT NOT NULL,
  FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE
);
```

### **ุฌุฏูู ุงููุฑุงุญู**
```sql
CREATE TABLE stages (
  id TEXT PRIMARY KEY,
  caseId TEXT NOT NULL,
  userId TEXT NOT NULL,
  stageName TEXT NOT NULL,
  stageIndex INTEGER NOT NULL,
  input TEXT,
  output TEXT,
  createdAt TEXT NOT NULL,
  completedAt TEXT,
  status TEXT DEFAULT 'pending',
  metadata TEXT,
  FOREIGN KEY (caseId) REFERENCES cases(id) ON DELETE CASCADE,
  FOREIGN KEY (userId) REFERENCES users(id) ON DELETE CASCADE
);
```

## ๐ ุงููุฌุฑุฉ ูู ุงููุธุงู ุงููุฏูู

### **ุงูุฎุทูุงุช:**
1. **ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑูุฒูุฉ**
2. **ุชุตุฏูุฑ ุงูุจูุงูุงุช ูู ุงููุธุงู ุงููุฏูู**
3. **ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ูููุธุงู ุงูุฌุฏูุฏ**
4. **ุงุฎุชุจุงุฑ ุงููุธุงู**
5. **ุฅุฒุงูุฉ ุงููุธุงู ุงููุฏูู**

### **ุฃุฏูุงุช ุงููุฌุฑุฉ:**
- ุชุตุฏูุฑ ุงูุจูุงูุงุช ุฅูู JSON
- ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ุนุจุฑ API
- ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- ุงุฎุชุจุงุฑ ุงูุฎุตูุตูุฉ

## ๐จ ููุงุญุธุงุช ูููุฉ

### **ุงูุฃูุงู:**
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุญููุฉ ุจู `userId` ููู ุนูููุฉ
- ูุง ูููู ูุฃู ูุณุชุฎุฏู ุชุฌุงูุฒ ุญุฏูุฏ ุงูุฎุตูุตูุฉ
- ุฌููุน ุงูุนูููุงุช ุชูุณุฌู ููุชุชุจุน

### **ุงูุฃุฏุงุก:**
- ููุงุฑุณ ูุญุณูุฉ ููุงุณุชุนูุงูุงุช ุงูุณุฑูุนุฉ
- ุงุณุชุนูุงูุงุช ูุญุณูุฉ ููุฎุตูุตูุฉ
- ุชุฎุฒูู ูุคูุช ููุจูุงูุงุช ุงููุชูุฑุฑุฉ

### **ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:**
- ูุณุฎ ุงุญุชูุงุทูุฉ ุฏูุฑูุฉ
- ุงุณุชุฑุฏุงุฏ ุงูุจูุงูุงุช ูู ุญุงูุฉ ุงูุทูุงุฑุฆ
- ุชุชุจุน ุงูุชุบููุฑุงุช

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

### **ูู ุญุงูุฉ ุงููุดุงูู:**
1. ุชุญูู ูู ุณุฌูุงุช ุงูุฎุงุฏู
2. ุงุฎุชุจุฑ ุงููุธุงู ุนุจุฑ ุตูุญุฉ ุงูุงุฎุชุจุงุฑ
3. ุชุญูู ูู ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. ุฑุงุฌุน ุณุฌูุงุช ุงูุฃุฎุทุงุก

### **ูููุทูุฑูู:**
- ุฌููุน ุงูุนูููุงุช ููุณุฌูุฉ ูู Console
- API ูุนูุฏ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- ุงุฎุชุจุงุฑุงุช ุดุงููุฉ ูุชุงุญุฉ

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### **ูุตูุฑุฉ ุงููุฏู:**
- [ ] ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุดุงูู
- [ ] ุงุฎุชุจุงุฑ ุงูุฎุตูุตูุฉ
- [ ] ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก

### **ูุชูุณุทุฉ ุงููุฏู:**
- [ ] ูุฌุฑุฉ ุงูุจูุงูุงุช ูู ุงููุธุงู ุงููุฏูู
- [ ] ุชุฏุฑูุจ ุงููุณุชุฎุฏููู
- [ ] ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### **ุทูููุฉ ุงููุฏู:**
- [ ] ุชุญุณููุงุช ุงูุฃุฏุงุก
- [ ] ููุฒุงุช ุฅุถุงููุฉ
- [ ] ุชูุณูุน ุงููุธุงู

---

**๐ ุชูุงูููุง! ุงูุขู ูุฏูู ูุธุงู ูุงุนุฏุฉ ุจูุงูุงุช ูุฑูุฒู ูุชูุฏู ูุน ุฎุตูุตูุฉ ูุถูููุฉ ููุฒุงููุฉ ููุฑูุฉ!**
